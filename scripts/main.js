"use strict";function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function completeArr(e){var t=0,n=!1;e:for(var i=1;i<e.length;i++)for(var s=1+e[i-1];s<e[i];s++)if(t=s,t>0)break e;return 0!=t&&Number.isInteger(t)?(n=!1,e.push(t),e.sort(),t):(n=!0,incrementArr(e))}function incrementArr(e){return e[e.length]=e.length+1}function removeArr(e,t){var n=e.indexOf(t);if(Array.isArray(e),n>-1)return e.splice(n,1),!0}function startTime(){var e=new Date,t=e.getHours(),n=e.getMinutes();n=checkTime(n);var i=t>=12?"PM":"AM";t=(t+11)%12+1,$("#clock .text").html(t+":"+n+" "+i);setTimeout(startTime,1e3)}function checkTime(e){return e<10&&(e="0"+e),e}function log(e){console.log(e)}function l(e){console.log(e)}function main(){var e;mobilecheck()?(SystemUI.setDialogBox("body","Mobile device detected",2,"This website was designed as a desktop experience. To use it on mobile, please request desktop version and switch to landscape mode"),$("body #dialog").css("display","block"),$("body #dialog").css("zIndex",2147483645),$("body #dialog button").off().on("click",function(){e=new login,$("body #dialog").remove(),SystemUI.removeOverlay(),window.innerHeight>window.innerWidth&&SystemUI.setDialogBox("desktop","Mobile Device Potrait",2,"This website is best viewed in landscape mode")}),$(window).on("orientationchange",function(e){window.innerHeight>window.innerWidth?(SystemUI.setDialogBox("desktop","Mobile Device Potrait",2,"This website is best viewed in landscape mode"),$("#desktop-icons").setInitialIcons()):$("#desktop-icons").setInitialIcons()})):e=new login}function isFirstLogin(){var e=JSON.parse(localStorage.getItem("currentUser"));return e.creationDate===e.lastLogin}var _get=function e(t,n,i){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,n);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,i)}if("value"in s)return s.value;var o=s.get;if(void 0!==o)return o.call(i)},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),toType=function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()};Array.prototype.inArray=function(e){for(var t=0;t<this.length;t++)if(e(this[t]))return!0;return!1},Array.prototype.pushIfNotExist=function(e,t){this.inArray(t)||(this.push(e),this.sort())},Array.prototype.contains=function(e){for(var t=this.length;t--;)if(this[t]==e)return!0;return!1},jQuery.cachedScript=function(e,t){return t=$.extend(t||{},{dataType:"script",cache:!1,url:e}),jQuery.ajax(t)},window.mobilecheck=function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},$.fn.setInitialIcons=function(e){return e=$.extend({selector:'.desktop-icon[program-name!="recyclebin"]',marginTop:26,marginLeft:0},e),this.each(function(){var t=$(this),n=$(e.selector,t),i=$(window).height(),s=$(n[0]).height(),a=$(n[0]).width(),o=Math.floor(i/(s+e.marginTop)),l=0,r=0;n.each(function(t){t%o==0&&t>0?(l=0,r+=a+e.marginLeft+4):l=l,$(this).css({top:l,left:r+e.marginLeft}),l+=s+e.marginTop})})};var programData={getIcon:function(e){var t="../images/win98_icons/";switch(e){case"msword":return t+"WINWORD_2.ico";case"notepad":return t+"notepad_file.ico";case"mail":return t+"mail.ico";case"minesweeper":return t+"minesweeper.ico";case"winamp":return t+"winamp.ico";case"wolf-3d":return t+"wolf3d.ico";case"iexplorer":return t+"msie2.ico";case"explorer":return t+"hard_disk_drive.ico";default:return console.log("Don't have icon for this program"),t+"msie2.ico"}},getIconByType:function(e){var t="../images/win98_icons/";switch(e){case"word":case"doc":return t+"WINWORD_2.ico";case"text":case"txt":return t+"notepad_file.ico";case"pdf":return t+"pdf.png";default:console.log("Don't have icon for this program")}}},zIndex=100,kernel=function(){function e(){_classCallCheck(this,e),this.init()}return _createClass(e,[{key:"init",value:function(){}},{key:"store",value:function(){Modernizr.localstorage?(localStorage.setItem("processes",""),localStorage.setItem("recycleBin",""),localStorage.setItem("Kernel Log",""),localStorage.setItem("processID","[]"),localStorage.setItem("docNumber","[]")):log("No Storage")}},{key:"vfsInit",value:function(){var e=localStorage.getItem("fileSystem");e?this.vfsSetup():this.vfsInit(e)}},{key:"vfsSetup",value:function(){}}],[{key:"getFileFromLocal",value:function(e){var t,n=$.grep(JSON.parse(localStorage.getItem("users")).users,function(e){return e.username==JSON.parse(localStorage.getItem("currentUser")).username});if(1==n.length)var i=n[0];for(var s=0;s<i.files.length;s++)if(e===i.files[s].fileID){t=i.files[s];break}return t}}]),e}(),process=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"newProcess",value:function(){var e=this.processIDStore();return e}},{key:"processIDStore",value:function(){var e=JSON.parse(localStorage.getItem("processID")),t=completeArr(e);return localStorage.setItem("processID",JSON.stringify(e)),t}},{key:"processIDRemove",value:function(e){e=parseInt(e);var t=JSON.parse(localStorage.getItem("processID"));removeArr(t,e);return localStorage.setItem("processID",JSON.stringify(t)),!0}},{key:"addProcess",value:function(e,t,n,i){}},{key:"removeProcess",value:function(e){}},{key:"setStorage",value:function(){}},{key:"setProcessActive",value:function(e){}},{key:"setProcessInActive",value:function(e){}}],[{key:"remove",value:function(e){}}]),e}(),SystemUI=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){this.windowInitalPositionValues(),this.contextMenuInit(),this.runInit()}},{key:"eventListeners",value:function(){var e=this;$("#desktop").on("focus click",".desktop-icon",function(){return $(this).hasClass("disabled")?0:($(".desktop-icon").children().removeClass("active"),void $(this).children().addClass("active"))}),$("#desktop").on("focusout",".desktop-icon",function(){return $(this).hasClass("disabled")?0:void $(".desktop-icon").children().removeClass("active")}),$("#desktop").on("dblclick touchend",".desktop-icon",function(t){return $(this).hasClass("disabled")?0:(t.stopPropagation(),t.preventDefault(),void e.program(this))}),$("#desktop").on("click",".minimize",function(){var t=$(this).closest("[pid]").attr("pid");e.minimize(t)}),$("#desktop").on("click",".maximize",function(){var t=$(this).closest("[pid]").attr("pid");e.maximize(t)}),$("#desktop").on("click",".close",function(){e.close(this),$(this).css("pointer-events","auto")}),$("#desktop").on("mousedown",".window",function(t){t.stopPropagation(),"dialog"!==t.currentTarget.id&&e.setActive($(this).attr("pid"))}),$("#desktop").on("resizestop",".window",function(e,t){$(this).data({originalTop:t.position.top,originalLeft:t.position.left,originalDisplay:$(this).css("display"),originalPosition:$(this).css("position"),originalHeight:t.size.height,originalWidth:t.size.width,originalOpacity:$(this).css("opacity")})}),$("#desktop").on("dblclick",".ui-resizable > div.window-border > .title-bar > .title",function(){var t=$(this).closest("[pid]").attr("pid");e.maximize(t)}),$("#desktop").on("click",".b-new",function(t){e.newWord()}),$("#desktop").on("click",".b-save",function(t){t.preventDefault();var n=$(this).closest("[id]").attr("id");e.showSave(n)}),$("#desktop").on("click",".b-open",function(t){t.preventDefault();var n=$(this).closest("[id]").attr("id");e.showOpen(n)}),$("#desktop").on("click",".b-print",function(){var t=$(this).closest("[id]").attr("id");e.printFile(t)}),$("#desktop").on("click",".b-attach",function(t){t.preventDefault();var n=$(this).closest("[id]").attr("id"),i="#"+n+" #attach";$(i).css("display","block"),e.updateContentBox(i);var s=$(i).offset();$(i).css({top:s.top,left:s.left,position:"fixed"}),$("#"+n).closest("[id]").css("pointer-events","none"),$(i).css("pointer-events","auto")}),$("#desktop").on("click",".attachment .cancel",function(){$(this).parent().remove()}),$("#desktop").on("click",".b-send",function(t){t.preventDefault(),e.sendEmail($(this).closest("[id]").attr("id"))}),$("#menu-8").on("click",function(){$("#run").draggable({handle:".title-bar"}),e.setActive($("#run").attr("pid"))}),$("#run .ok-button").on("click",function(){"ok"===$(this).val()?e.runProgram(escape($("#run input").val())):$("#run").css("display","none")}),$("#run .close-run,#run .close-button").on("click",function(){var t=$(this).closest("[pid]").attr("pid");e.beforeWindow(t,function(){e.programMinimize(t)})}),$("#desktop").on("focus click",".folder-icon",function(){if(!$(this).hasClass("folder-url")){$(".folder-icon").children().removeClass("active"),$(this).children().addClass("active");var e=$(this).closest("[pid]").attr("id"),t=kernel.getFileFromLocal($(this).attr("fileid")),n=Math.round(2*JSON.stringify(t).length/1024);$("#"+e+" .box.size").text(n+" KB")}}),$("#desktop").on("focusout",".folder-icon",function(){if(!$(this).hasClass("folder-url")){$(".folder-icon").children().removeClass("active");var e=$(this).closest("[pid]").attr("id");$("#"+e+" .box.size").text("")}}),$("#desktop").on("dblclick touch",".folder-icon",function(t){t.preventDefault(),t.stopPropagation(),$(this).hasClass("folder-url")||e.program(this)}),$("#desktop").on("dblclick touch",".folder-url",function(e){e.preventDefault(),e.stopPropagation(),window.open($(this).attr("url"))}),$("#desktop").on("click",".properties .button",function(e){var t=$(this).closest("[id]").attr("id");$("#"+t+" .close").trigger("click")}),$("#menu-10").on("click",function(){e.shutdown()}),$("#menu-9").off().on("click",function(){e.beforeLogoff()}),$(".sub-menu-item").on("click",function(t){t.stopPropagation(),t.preventDefault(),e.program(this)}),$("#desktop").on("click",".close-save,\t.cancel-button",function(){var e=$(this).closest("[id]").attr("id"),t=$(this).closest("[id]").parent().closest("[id]").attr("id");$("#"+t+" #"+e).css("display","none"),$("#"+t).css("pointer-events","auto")}),$("#desktop").on("click",".save-button",function(){e.save(this)}),$("#desktop").on("click",".desktop-ico",function(){$(this).siblings("#save-location").val("desktop")}),$("#desktop").on("click",".open-button",function(){e.open(this)}),$("#desktop").on("click",".attach-button",function(){e.attach(this)});$("#desktop").on("click",".user-file-list",function(e){var t=$(this).children().text(),n=$(this).attr("type"),i=$(this).attr("fileid"),s=$(this).closest("[id]").attr("id");if(e.shiftKey)if("attach"==s){$(this).addClass("selected");var a=$(this).closest("[id]").find(".fileID").val(),o=$(this).closest("[id]").find(".filename").val();o.indexOf('"')<0&&(o='"'+o+'"'),$(this).closest("[id]").find(".filename").val(o+' "'+t+'" '),$(this).closest("[id]").find(".fileID").val(a+"|"+i),$(this).closest("[id]").find("#file-type").val("none")}else $(".user-file-list").removeClass("selected"),$(this).closest("[id]").find(".filename").val(t),$(this).closest("[id]").find("#file-type").val(n),$(this).closest("[id]").find(".fileID").val(i);else $(".user-file-list").removeClass("selected"),$(this).toggleClass("selected"),$(this).closest("[id]").find(".filename").val(t),$(this).closest("[id]").find("#file-type").val(n),$(this).closest("[id]").find(".fileID").val(i)}),$("#desktop").on("blur",".user-file-list",function(){}),$("#dialog button").on("click",function(){}),$("#menu-2").hover(function(){$("#sub-menu-2").css("display","block")},function(){$("#sub-menu-2").hover(function(){$("#sub-menu-2").css("display","block")},function(){$("#sub-menu-2").css("display","none")})}),$(document).mouseup(function(e){var t=$("#start-menu");t.is(e.target)||0!==t.has(e.target).length||(t.slideUp(),$("#sub-menu-2").css("display","none"))}),$("#start-menu").on("click",function(){"block"==$("#start-menu").css("display")?$("#start-menu").slideUp():$("#start-menu").slideDown()}),$(document).on("click","#start-button",function(){"block"==$("#start-menu").css("display")?$("#start-menu").slideUp():$("#start-menu").slideDown()}),$("#menu-2").hover(function(){$("#sub-menu-2").css("display","block")},function(){$("#sub-menu-2").hover(function(){$("#sub-menu-2").css("display","block")},function(){$("#sub-menu-2").css("display","none")})}),$("#desktop").on("click",".window-open",function(t){t.preventDefault();var n=this,i=$(n).attr("pid");$('.window[pid="'+i+'"]').is(":animated")?setTimeout(function(){$(n).hasClass("active-task")?e.setInActive(i):e.setActive(i)},800):$(n).hasClass("active-task")?e.setInActive(i):e.setActive(i)}),$("#taskbar .show-desktop").on("click",function(){$(".window").each(function(){$(this)[0].hasAttribute("pid")&&e.minimize($(this).attr("pid"))})}),$("#taskbar .new-mail").on("click",function(){e.newMail()}),$("#pageup").on("click",function(){e.upTaskPage()}),$("#pagedown").on("click",function(){e.downTaskPage()})}},{key:"program",value:function n(e){var i,s=$(e),n=s.attr("program-name"),a=s.attr("fileid"),o=this.isOpen(a);if(null!=o||"undefined"!=typeof o)this.setActive(o);else{var o=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"newProcess",this).call(this);switch(n){case"msword":var i=new MsWord(o,a);this.botOpen===!1&&(globalBot.agent(function(e){e.moveTo(.75*$(window).width(),.75*$(window).height()),e.speak("This is Microsoft Word. You can edit files and save them to the desktop which is internally stored to Local Storage. Be careful when you clear cache. You can also download the file to your own computer.")}),this.botWord=!0);break;case"notepad":var i=new Notepad(o,a);break;case"mail":globalBot.agent(function(e){e.moveTo(.75*$(window).width(),.75*$(window).height()),e.speak("Welcome to the mail client. You can compose emails here. If you want to get in touch with me contact me on rahulmehra@techgeek.co.in.")});var i=new MailClient(o);break;case"wolf-3d":var l=this.isRunning(n);if(l)this.setActive(l);else var i=new Wolf3d(o);break;case"minesweeper":var l=this.isRunning(n);if(l)this.setActive(l);else var i=new Minesweeper(o);break;case"winamp":var l=this.isRunning(n);if(l)this.setActive(l);else var i=new Winamp(o);break;case"recyclebin":this.beforeLogoff(!0);break;case"explorer":var i=new Explorer(o,s.attr("directory"))}i?(_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addProcess",this).call(this,o,n,i.windowID,i.description),this.setWindowPosition(i.windowID),this.appendTask(o,n,i.windowID,i.description),this.setActive(o)):console.log("No Process Returned")}}},{key:"isOpen",value:function(e){var t,n;return $(".window").each(function(){var i=$(this);if(n=i.attr("fileid"),e===n)return t=i.attr("pid"),!1}),t}},{key:"isRunning",value:function(e){var t=!1;return 0!=$('.window[program-name="'+e+'"]').length&&(t=$('.window[program-name="'+e+'"]').attr("pid")),t}},{key:"close",value:function(e){var t=this,n=$(e).closest("[pid]").attr("id");n="#"+n;var i=($(n).attr("id"),$(n).attr("pid")),s=$(n).attr("program-name");switch(s){case"msword":MsWord.remove($(n).attr("document-number"),function(e){t.programClose(i,e)});break;default:t.programClose(i,!0)}}},{key:"properties",value:function(e){var n=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"newProcess",this).call(this);this.newProperties(n,e)}},{key:"newProperties",value:function(e,t){var n=this.getFileFromLocal(t),i=2*JSON.stringify(n).length,s=new Date(n.creationDate),a=s.toDateString()+", "+s.toLocaleTimeString(),o=new Date(n.modifiedDate),l=o.toDateString()+", "+o.toLocaleTimeString(),r=programData.getIconByType(n.type),c='<div id="properties-'+e+'" class="properties window ui-widget-content" program-name="properties" pid="'+e+'">\n            <div class="window-border">\n                <div class="title-bar h-count" id="parent">\n                    <div class="control-box">\n                        <a class="button-3d close"><span>&nbsp;</span></a>\n                    </div>\n                    <span class="title">\n                    '+n.filename+' Properties\n                </span>\n                </div>\n                <div class="properties-content">\n                    <div class="tab">General</div>\n                    <div class="content">\n                        <div class="top"><img class="icon" src="'+r+'" />\n                            <p class="filename">'+n.filename+'</p>\n                        </div>\n                        <div class="sep"></div>\n                        <div class="middle">\n                            <table>\n                                <tr>\n                                    <th>Type:</th>\n                                    <td class="type">'+n.type+'</td>\n                                </tr>\n                                <tr>\n                                    <th>Location:</th>\n                                    <td class="location">Desktop/</td>\n                                </tr>\n                                <tr>\n                                    <th>Size:</th>\n                                    <td class="size">'+i+' Bytes</td>\n                                </tr>\n                            </table>\n                        </div>\n                        <div class="sep"></div>\n                        <div class="middle2">\n                            <table>\n                                <tr>\n                                    <th>MS-DOS name:</th>\n                                    <td class="msdos">'+n.filename+"."+n.type+'</td>\n                                </tr>\n                                <tr>\n                                    <th>Created:</th>\n                                    <td class="created">'+a+'</td>\n                                </tr>\n                                <tr>\n                                    <th>Modified:</th>\n                                    <td class="modified">'+l+'</td>\n                                </tr>\n                                <tr>\n                                    <th>Accessed:</th>\n                                    <td class="accessed">'+l+'</td>\n                                </tr>\n                            </table>\n                        </div>\n                        <div class="sep"></div>\n                        <div class="attributes">\n                            <table>\n                                <tr>\n                                    <th>Attributes:</th>\n                                    <td><div class="square">&nbsp;</div></td>\n                                    <td>Read-only</td>\n                                    <td><div class="square">&nbsp;</div></td>\n                                    <td>Hidden</td>\n                                </tr>\n                                <tr>\n                                    <th></th>\n                                    <td><div class="square">&nbsp;</div></td>\n                                    <td>Archive</td>\n                                    <td><div class="square">&nbsp;</div></td>\n                                    <td>System</td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                    <div class="bottom">\n                        <button class="button disabled-action" tabindex="-1">Apply</button>\n                        <button class="button close-button" value="cancel">Cancel</button>\n                        <button class="button ok-button" value="ok">Ok</button>\n                    </div>\n                    <div class="clear"></div>\n                </div>\n            </div>\n        </div>';$(c).appendTo("#desktop").show("fast").draggable({handle:".title-bar"});var d=$('.desktop-icon[fileid="'+n.fileID+'"]').offset();d.top=d.top>=$(window).height()/2?$(window).height()/2-32:d.top,$("#properties-"+e).css({top:d.top+32,left:d.left+32}),this.setActive(e)}},{key:"maximize",value:function(e){var t=this,n=$('.window[pid="'+e+'"]').attr("id");if(!$("#"+n).hasClass("wolf")){var i=$(window).height()-22,s=$('.window[pid="'+e+'"]').find(".maximize").attr("state");if("min"===s)t.beforeWindow(e,function(){if(!$('.window[pid="'+e+'"]').is(":animated")){if($('.window[pid="'+e+'"]').animate({opacity:1,top:0,left:0,height:i+"px",width:$(window).width()}),$('.window[pid="'+e+'"]').find(".maximize").attr("state","max"),$("#"+n).hasClass("word")){var t=i-(3*$("#"+n+" .toolbar").outerHeight()+60+$("#"+n+" .status-bar").outerHeight()+$(".title").outerHeight());$("#"+n+" .document-content").animate({height:t+"px"})}else if($("#"+n).hasClass("mail")){var t=i-246;$("#"+n+" .mail-content").animate({height:t+"px"})}else if($("#"+n).hasClass("notepad")){var t=i-74;$("#"+n+" .document-content").animate({height:t+"px"})}else if($("#"+n).hasClass("explorer")){var t=i-152;$("#"+n+" #explorer-content").animate({height:t+"px"})}$('.window[pid="'+e+'"]').find(".maximize").css("background-image","url(../images/window/max.png)"),$('.window[pid="'+e+'"]').draggable("disable").resizable("disable")}});else if("max"===s){var a=$('.window[pid="'+e+'"]').data();if(!$('.window[pid="'+e+'"]').is(":animated")){if($('.window[pid="'+e+'"]').animate({opacity:1,top:a.originalTop,left:a.originalLeft,width:a.originalWidth+"px",height:a.originalHeight+"px"}),$("#"+n).hasClass("word")){var o=a.originalContentHeight;$("#"+n+" .document-content").animate({height:o+"px"})}else if($("#"+n).hasClass("mail")){var o=a.originalContentHeight;$("#"+n+" .mail-content").animate({height:o+"px"})}else if($("#"+n).hasClass("notepad")){var o=a.originalContentHeight;$("#"+n+" .document-content").animate({height:o+"px"})}else if($("#"+n).hasClass("explorer")){var o=a.originalContentHeight;$("#"+n+" #explorer-content").animate({height:o+"px"})}$('.window[pid="'+e+'"]').find(".maximize").attr("state","min"),$('.window[pid="'+e+'"]').find(".maximize").css("background-image","url(../images/clippy/window/maximize.png)"),$('.window[pid="'+e+'"]').draggable("enable").resizable("enable")}}}}},{key:"minimize",value:function(e){var t=this,n=$('.window[pid="'+e+'"]').attr("id");n="#"+n;var i=$('.window[pid="'+e+'"]').find(".maximize").attr("state");"max"===i?t.programMinimize(e):"min"===i&&this.beforeWindow(e,function(){t.programMinimize(e)})}},{key:"beforeWindow",value:function(e,t){$('.window[pid="'+e+'"').promise().done(function(){var n=$('.window[pid="'+e+'"]'),i=n.offset(),s=i.top,a=i.left,o=n.css("position"),l=n.outerHeight(),r=n.outerWidth(),c=n.css("display"),d=n.css("opacity"),p=0;$('.window[pid="'+e+'"]').hasClass("word")?p=n.find(".document-content").outerHeight():$('.window[pid="'+e+'"]').hasClass("mail")?p=n.find(".mail-content").height():$('.window[pid="'+e+'"]').hasClass("notepad")?p=n.find(".document-wrap").outerHeight():$('.window[pid="'+e+'"]').hasClass("explorer")&&(p=n.find("#explorer-content").outerHeight()),n.data({originalTop:s,originalLeft:a,originalDisplay:c,originalPosition:o,originalHeight:l,originalWidth:r,originalOpacity:d,originalContentHeight:p}),t()})}},{key:"programClose",value:function(e,n){n===!0&&(this.removeWindow(e),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"removeProcess",this).call(this,e),this.removeTask(e))}},{key:"programMinimize",value:function(e){this.minimizeWindow(e),this.minimizeTask(e)}},{key:"setInActive",value:function(e){this.setTaskInActive(e),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setProcessInActive",this).call(this,e),this.minimize(e)}},{key:"setActive",value:function(e){this.setTaskActive(e),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setProcessActive",this).call(this,e),this.setWindowActive(e)}},{key:"windowInitalPositionValues",value:function(){this.h=$(window).height(),this.w=$(window).width(),this.topInit=this.h/12,this.leftInit=this.w/6,this.topVal=this.h/10,this.leftVal=this.w/3,this.totalheight=this.h/4,this.totalwidth=this.w/2,this.offsetpx=32,this.top1,this.left1,this.taskWidth=219,this.iconNumber=20,this.iconTop=0,this.iconLeft=0,isFirstLogin()?(this.botSave=!1,this.botOpen=!1,this.botWord=!1):(this.botSave=!0,this.botOpen=!0,this.botWord=!0)}},{key:"setWindowPosition",value:function(e){var t=$(e);if(!$(e).hasClass("winamp")){var n=t.offset();this.top1=n.top+this.topVal,this.topVal=this.topVal+this.offsetpx,this.left1=n.left+this.leftVal,this.leftVal=this.leftVal+this.offsetpx,t.offset({top:this.top1,left:this.left1}),$(e).height(.6*this.h),$(e+" .document-content").height(.6*this.h),$(e+" .mail-content").height(.6*this.h-246),this.topVal>this.totalheight&&(this.topVal=this.topInit,this.leftVal=this.leftVal+32),this.leftVal>this.totalwidth&&(this.topVal=this.topVal+32,this.leftVal=this.leftInit)}}},{key:"setWindowActive",value:function(e){var t,n=$('.window[pid="'+e+'"]'),i=n.find(".maximize").attr("state");if(!$('.window[pid="'+e+'"]').is(":animated")&&"0"===n.css("opacity"))if("max"===i){var s=$(window).height()-$("#taskbar").outerHeight();if(this.ani1=$('.window[pid="'+e+'"]').animate({opacity:1,top:0,left:0,height:s+"px",width:$(window).width()}),$('.window[pid="'+e+'"]').hasClass("word")){var a=s-(3*$('.window[pid="'+e+'"] .toolbar').outerHeight()+48+$('.window[pid="'+e+'"] .status-bar').outerHeight()+$(".title").outerHeight());$('.window[pid="'+e+'"] .document-content').animate({height:a})}else if($('.window[pid="'+e+'"]').hasClass("mail")){var a=s-246;$('.window[pid="'+e+'"] .mail-content').animate({height:a})}else if($('.window[pid="'+e+'"]').hasClass("mail")){var a=s-150;$('.window[pid="'+e+'"] .explorer-content').animate({height:a})}}else if("min"===i)if(t=n.data(),n.animate({opacity:1,top:t.originalTop,left:t.originalLeft,width:t.originalWidth+"px",height:t.orignalHeight+"px"}),$('.window[pid="'+e+'"]').hasClass("word")){var a=t.originalContentHeight;$('.window[pid="'+e+'"] .document-content').animate({height:a})}else if($('.window[pid="'+e+'"]').hasClass("mail")){var a=t.originalContentHeight;$('.window[pid="'+e+'"] .mail-content').animate({height:a})}zIndex++,n.css({zIndex:zIndex}),n.css("display","block"),$(".window").removeClass("active-window"),n.hasClass("winamp")||n.addClass("active-window")}},{key:"setWindowInActive",value:function(e){$(".window").removeClass("active-window")}},{key:"removeWindow",value:function(e){$('.window[pid="'+e+'"]').animate({opacity:0,top:$(window).height(),left:0,width:"0px",height:0}),$('.window[pid="'+e+'"]').hasClass("winamp")&&$('script[src*="winamp2-js/built/winamp.js"]').remove(),$('.window[pid="'+e+'"]').promise().done(function(){$('.window[pid="'+e+'"]').remove()})}},{key:"minimizeWindow",value:function(e){$('.window[pid="'+e+'"]').is(":animated")||($('.window[pid="'+e+'"]').animate({opacity:0,top:$(window).height(),left:0,width:"0px",height:0}),$('.window[pid="'+e+'"]').promise().done(function(){$('.window[pid="'+e+'"]').css({display:"none"})}))}},{key:"shutdown",value:function(){var e=this;$("#menu").css("display","none"),$("#desktop").css("pointer-events","none"),$("#shutdown").css("display","block"),t.insertOverlay("shutdown",!0),$("#shutdown").off().on("click",".close",function(){t.removeOverlay(),$("#shutdown").css("display","none"),$("#desktop").css("pointer-events","auto")}),$("#shutdown button").off().on("click",function(){if("ok"===$(this).val())switch($("input[name=shut]:checked").val()){case"shutdown":return void e.beforeFinalShutdown("shutdown");case"restart":return void e.beforeFinalShutdown("restart");case"stand-by":return void e.enterStandby();default:t.setDialogBox("shutdown","Programs","1","No Option Selected.")}else $("#shutdown #dialog").remove(),$("#shutdown").css("display","none"),t.removeOverlay(),$("#desktop").css("pointer-events","auto")})}},{key:"beforeSystemClose",value:function(e,n){var i=($("#"+e),!0);$(".window").each(function(){"false"===$(this).attr("saved")&&(i=!1)}),i?n(!0):(t.setDialogBox(e,"Programs","4","Are you sure you want to close all windows before exiting?"),$("#"+e+" #dialog button").off().on("click",function(){$("#"+e).css("pointer-events","auto"),$("#"+e).css("zIndex","2147483646");var t=$(this).attr("value");"yes"===t?n(!0):($("#"+e+" #dialog").remove(),n(!1))}))}},{key:"beforeFinalShutdown",value:function(e){var n=this;this.beforeSystemClose("shutdown",function(i){i?"shutdown"===e?n.finalShutdown():"restart"===e?n.restart():"logoff"===e&&n.logoff():($("#shutdown").css("display","none"),$("#desktop").css("pointer-events","auto"),t.removeOverlay())})}},{key:"finalShutdown",value:function(){$("body").html(""),$("body").css("background","url(../images/shutdown.jpg) no-repeat center"),sound.play("sprite3"),setTimeout(function(){$("body").css("background","none").html('<h1 style="text-align:center; margin:0 auto;">If you want to see more cool stuff.<br> Go to <a href = "https://github.com/lolstring/">https://github.com/lolstring/</a>.<br> You can contact me on <a href=rahulmehra@techgeek.co.in>rahulmehra@techgeek.co.in</a>.<br> <br><br> <a href="https://rahul.io">Power On</a></h1>')},4e3)}},{key:"restart",value:function(){$("body").html(""),$("body").css("background","url(../images/shutdown.jpg) no-repeat center"),sound.play("sprite3"),setTimeout(function(){location.reload()},2e3)}},{key:"enterStandby",value:function(){var e=this,n='<div id="standby" style="width:100%; height:100%; position:fixed; top:0; left:0;"></div>';$(n).appendTo("body"),$("#shutdown").css("display","none"),
$("#desktop").css("pointer-events","none"),t.setDialogBox("standby","Stand By","1","Click ok to stand by"),$("#standby").css("zIndex",2147483646),$("#standby button").off().on("click",function(){e.exitStandBy()})}},{key:"exitStandBy",value:function(){t.removeOverlay(),$("#standby").remove(),$("#desktop").css("pointer-events","auto")}},{key:"destroySession",value:function(){localStorage.clear()}},{key:"beforeLogoff",value:function(e){var n=this,i="#logoff";e&&$("#logoff p").text("Are you sure you want to destroy session and logoff?"),$("#logoff").css("display","block"),$("#desktop").css("pointer-events","none"),t.insertOverlay("logoff",!0),$("#logoff").off().on("click",".close",function(){t.removeOverlay(),$("#logoff").css("display","none"),$("#desktop").css("pointer-events","auto")}),$(i+" button").on("click",function(){$(i).css("pointer-events","auto"),$(i).css("zIndex","2147483646");var s=$(this).attr("value");"yes"===s?n.beforeSystemClose("logoff #dialog",function(i){i?(e&&n.destroySession(),n.logoff(),t.removeOverlay()):($("#logoff").css("display","none"),t.removeOverlay(),$("#desktop").css("pointer-events","auto"))}):(t.removeOverlay(),$("#logoff").css("display","none"),$("#desktop").css("pointer-events","auto")),$("#logoff p").text("Are you sure you want to logoff?")})}},{key:"logoff",value:function(){sound.play("sprite3"),setTimeout(function(){location.reload()},4e3)}},{key:"runInit",value:function(){$.widget("ui.combobox",{sendCmd:function(e){},_create:function(){this.wrapper=$("<span>").addClass("custom-combobox").insertAfter(this.element),this.element.hide(),this._createAutocomplete(),this._createShowAllButton()},_createAutocomplete:function(){var e=this.element.children(":selected"),t=e.val()?e.text():"";this.input=$("<input>").appendTo(this.wrapper).val(t).attr("tabindex","0").addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left").autocomplete({delay:0,minLength:0,source:$.proxy(this,"_source")}).tooltip({tooltipClass:"ui-state-highlight"}),this._on(this.input,{autocompleteselect:function(e,t){t.item.option.selected=!0,this._trigger("change",e,{item:t.item.option}),this.sendCmd(t.item.value)},autocompletechange:"_removeIfInvalid"})},_createShowAllButton:function(){var e=this.input,t=!1;$("<a>").attr("tabIndex",-1).appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("custom-combobox-toggle ui-corner-right").mousedown(function(){t=e.autocomplete("widget").is(":visible")}).click(function(){t||e.autocomplete("search","")})},_source:function(e,t){var n=new RegExp($.ui.autocomplete.escapeRegex(e.term),"i");t(this.element.children("option").map(function(){var t=$(this).text();if(this.value&&(!e.term||n.test(t)))return{label:t,value:t,option:this}}))},_removeIfInvalid:function(e,t){if(!t.item){var n=this.input.val(),i=n.toLowerCase(),s=!1;this.element.children("option").each(function(){if($(this).text().toLowerCase()===i)return this.selected=s=!0,!1}),s||(this.element.append($("<option>",{value:this.input.val(),text:this.input.val()})),this.input.autocomplete("instance").term="")}},_destroy:function(){this.wrapper.remove(),this.element.show()}}),$("#combobox").combobox()}},{key:"runProgram",value:function(e){var n=e.toLowerCase(),i=$("#run").attr("pid"),s=this;if(~n.indexOf("word"))this.newWord();else if(~n.indexOf("notepad"))this.newNotepad();else if(~n.indexOf("winamp"))this.newWinamp();else if(~n.indexOf("mail"))this.newMail();else if(~n.indexOf("minesweeper"))$('.desktop-icon[program-name="minesweeper"]').trigger("dblclick");else if(~n.indexOf("wolf"))this.newWolf();else if(~n.indexOf("help"))console.log(this.runProgram.toString());else if(~n.indexOf(".doc")){e=e.replace(".doc","");var a=this.checkIfFileExists(e,"doc");if(!a)return void t.setDialogBox("run","Error","1","Please check your file name. Click OK to continue.");this.newWord(a)}else if(~n.indexOf(".pdf")){e=e.replace(".pdf","");var a=this.checkIfFileExists(e,"pdf");if(!a)return void t.setDialogBox("run","Error","1","Please check your file name. Click OK to continue.");this.newWord(a)}else{if(!~n.indexOf(".txt"))return void t.setDialogBox("run",e,"1","Cannot find the file "+e+". Make sure the path and filename are correct and that all required libraries are available.<br> Commands Supported:<br>&nbsp;&#149;Installed Executable<br>&nbsp;&#149;Filename with Extension<br>&nbsp;");e=e.replace(".txt","");var a=this.checkIfFileExists(e,"txt");if(!a)return void t.setDialogBox("run","Error","1","Please check your file name. Click OK to continue.");this.newNotepad(a)}s.beforeWindow(i,function(){s.programMinimize(i)})}},{key:"showOpen",value:function(e){var t="#"+e+" #open";$(t).css("display","block"),this.updateContentBox(t);var n=$(t).offset();$(t).css({top:n.top,left:n.left,position:"fixed"}),$("#"+e).closest("[id]").css("pointer-events","none"),$(t).css("pointer-events","auto"),this.botOpen===!1&&(globalBot.agent(function(e){e.moveTo(n.left+150,n.top+150),e.speak("You can open a file from this desktop.")}),this.botOpen=!0)}},{key:"showSave",value:function(e){var t="#"+e+" #save";$(t).css("display","block"),this.updateContentBox(t);var n=$(t).offset();$(t).css({top:n.top,left:n.left,position:"fixed"}),$("#"+e).closest("[id]").css("pointer-events","none"),$(t).css("pointer-events","auto"),this.botSave===!1&&(globalBot.agent(function(e){e.moveTo(n.left+150,n.top+150),e.speak("You can save to desktop which is internally stored to Local Storage so be careful when you clear cache or you can download it to your own computer.")}),this.botSave=!0)}},{key:"updateContentBox",value:function(e){var t=$(e+" .content1-box");$(e+" .user-file-list").remove();var n,i,s,a,o=this.getFromLocal();$.each(o,function(e,o){s=o.type,a=o.filename,"doc"===s||"word"===s?(n="doc",i="images/win98_icons/WINWORD_2.ico"):"pdf"===s?(n=s,i="images/win98_icons/pdf.png"):"txt"===s&&(n=s,i="images/win98_icons/notepad_file.ico");var l='<div class="folder-list user-file-list" fileID="'+o.fileID+'" type="'+n+'" tabindex="0"><img class="icon" src="'+i+'" style="width:14px;"/><span style="vertical-align:top">'+a+"</span></div>";$(l).appendTo(t)})}},{key:"print",value:function(e){return xepOnline.Formatter.Format(parentId+"-content .document-wrap",{render:"newwin",filename:"print"})}},{key:"printFile",value:function(e){return xepOnline.Formatter.Format(e+"-content .document-wrap",{render:"newwin",filename:"print"})}},{key:"open",value:function(e){var n=this,i=$(e).closest("[id]").parent().closest("[id]").attr("id"),s="#"+i,a=$(s+" #open .fileID").val(),o=$(s+" #open input.filename").val();if(""==o)t.setDialogBox(i,"Error","1","Please enter a file name. Click OK to continue."),$(s+" #open").css("pointer-events","none"),$("#dialog button").on("click",function(){$(s+" #open").css("pointer-events","auto")});else{var l=$(s).attr("saved");if("false"==l){t.setDialogBox(i,"Microsoft Word","4","Are you sure you want to close before exiting?");$(s+" #dialog button").on("click",function(){$(s).css("pointer-events","auto");var e=$(this).attr("value");if("yes"==e){var t=n.getFileFromLocal(a);$(s).children().children().children(".title").text(t.filename),$("#task-"+i+" p").text(o),$(s).find(".document-wrap").html(t.content),$(s).attr("fileid",a),MsWord._wordNumberRemove($(s).attr("docNumber")),$(s+" #open").css("display","none"),$(s).css("pointer-events","auto"),$(s).attr("saved","true")}else"no"==e?($(s+" #dialog").css("display","none"),$(s+" #open").css("display","block")):"cancel"==e&&($(s+" #dialog").css("display","none"),$(s+" #open").css("display","block"))})}else{var r=this.getFileFromLocal(a);$(s).children().children().children(".title").text(r.filename),$("#task-"+i+" p").text(o),$(s).find(".document-wrap").html(r.content),$(s).attr("fileid",a),MsWord._wordNumberRemove($(s).attr("docNumber")),$(s+" #open").css("display","none"),$(s).css("pointer-events","auto"),$(s).attr("saved","true")}}}},{key:"save",value:function(e){var n=$(e).closest("[id]").parent().closest("[id]").attr("id"),i="#"+n,s=$(i+" #save select#file-type").val(),a=$(i+" #save select#save-location").val(),o=$(i+" #save input.filename").val();if(""==o)t.setDialogBox(n,"Error","1","Please enter a file name. Click OK to continue."),$(i+" #save").css("pointer-events","none"),$("#dialog button").on("click",function(){$(i+" #save").css("pointer-events","auto")});else{if("desktop"===a){var l=$(i+"-content .document-wrap").html();l.trim();this.saveToLocal(n,o,l,s);var r=o+" - Microsoft Word";$(i).children().children().children(".title").text(r),$("#task-"+n+" p").text(o),$(i+" #save").css("display","none"),$(i).css("pointer-events","auto")}else"computer"===a?(this.saveFile(n,o,s),$(i+" #save").css("display","none")):null===a&&t.setDialogBox(n,"Error","1","Please Choose a location.");$("#dialog button").on("click",function(){$(i).css("pointer-events","auto")})}}},{key:"getFromLocal",value:function(){var e,t=[],n=$.grep(JSON.parse(localStorage.getItem("users")).users,function(e){return e.username==JSON.parse(localStorage.getItem("currentUser")).username});if(1==n.length)var e=n[0];return null!=e&&"undefined"!=typeof e&&e.files.length>0?($.each(e.files,function(e,n){var i={fileID:n.fileID,program:n.program,filename:n.filename,type:n.type};t.pushIfNotExist(i,function(e){return e.fileID===i.fileID&&e.filename===i.filename&&e.type===i.type})}),t):void console.log("No Files")}},{key:"getFileFromLocal",value:function(e){var t,n=$.grep(JSON.parse(localStorage.getItem("users")).users,function(e){return e.username==JSON.parse(localStorage.getItem("currentUser")).username});if(1==n.length)var i=n[0];for(var s=0;s<i.files.length;s++)if(e===i.files[s].fileID){t=i.files[s];break}return t}},{key:"saveToLocal",value:function(e,n,i,s){if("undefined"!=typeof Storage){$("#"+e).attr("saved",!0);var a=$("#"+e).attr("program-name"),o=$.grep(JSON.parse(localStorage.getItem("users")).users,function(e){return e.username==JSON.parse(localStorage.getItem("currentUser")).username});if(1==o.length)var l=o[0];var r=this.checkIfFileExists(n,s);if(r)if($("#"+e).attr("fileid")!=r)t.setDialogBox(e,"Microsoft Word","4","Do you want to replace the existing "+n+"."+s+"?"),$("#"+e+" #dialog button").on("click",function(){var t=$(this).attr("value");if("yes"==t){for(var a=0;a<l.files.length;a++)if(n===l.files[a].filename&&s===l.files[a].type){$("#"+e).attr("fileid",l.files[a].fileID),l.files[a].content=i,l.files[a].modifiedDate=Date.now();break}var o=JSON.parse(localStorage.getItem("users"));$.each(o.users,function(e,t){if(this.username===JSON.parse(localStorage.getItem("currentUser")).username)return this.files=l.files,!1}),localStorage.setItem("users",JSON.stringify(o)),$("#"+e+" #dialog").css("display","none")}else"no"==t?($("#"+e+" #dialog").css("display","none"),$("#"+e+" #save").css("display","block")):"cancel"==t&&$("#"+e+" #dialog").css("display","none")});else{for(var c=0;c<l.files.length;c++)if(n===l.files[c].filename&&s===l.files[c].type){$("#"+e).attr("fileid",l.files[c].fileID),l.files[c].content=i,l.files[c].modifiedDate=Date.now();break}var d=JSON.parse(localStorage.getItem("users"));$.each(d.users,function(e,t){if(this.username===JSON.parse(localStorage.getItem("currentUser")).username)return this.files=l.files,!1})}else if(!r){var p="file-"+Date.now();l.files.push({fileID:p,filename:n,content:i,type:s,program:a,creationDate:Date.now(),modifiedDate:Date.now()});var d=JSON.parse(localStorage.getItem("users"));$.each(d.users,function(e,t){if(this.username===JSON.parse(localStorage.getItem("currentUser")).username)return this.files=l.files,!1}),localStorage.setItem("users",JSON.stringify(d)),$("#"+e).attr("fileid",p),this.setNewDesktop(p,a,n,s)}}else console.log("Local storage is not supported")}},{key:"checkIfFileExists",value:function(e,t){var n,i,s=$.grep(JSON.parse(localStorage.getItem("users")).users,function(e){return e.username==JSON.parse(localStorage.getItem("currentUser")).username});if(1==s.length)var a=s[0];return $.each(a.files,function(){return this.filename==e&&this.type==t?(n=!0,i=this.fileID,!1):void(this.filename!=e&&(i=!1))}),i}},{key:"rename",value:function(e,t){var n=$.grep(JSON.parse(localStorage.getItem("users")).users,function(e){return e.username==JSON.parse(localStorage.getItem("currentUser")).username});if(1==n.length)var i=n[0];for(var s=0;s<i.files.length;s++)if(e===i.files[s].fileID){i.files[s].filename=t,i.files[s].modifiedDate=Date.now();break}var a=JSON.parse(localStorage.getItem("users"));$.each(a.users,function(e,t){if(this.username===JSON.parse(localStorage.getItem("currentUser")).username)return this.files=i.files,!1}),localStorage.setItem("users",JSON.stringify(a));var o=$('.window[fileid="'+e+'"]').attr("pid");$('.window[fileid="'+e+'"]').find(".title").text(t),$('#taskbar [pid="'+o+'"] p').text(t)}},{key:"saveFile",value:function(e,t,n){if("pdf"==n)return $("#"+e).css("pointer-events","auto"),xepOnline.Formatter.Format(e+"-content .document-wrap",{render:"download",filename:t});if("word"==n||"doc"==n)this.convertImagesToBase64(e),$.cachedScript("scripts/vendor.js").done(function(n,i){var s=$("#"+e+"-content").html(),a="<!DOCTYPE html><html><head></head><body>"+s+"</body></html>",o="potrait",l=htmlDocx.asBlob(a,{orientation:o});saveAs(l,t+".docx")});else if("txt"==n){var i=$("#"+e+"-content").text();i=i.trim();var s=new Blob([i],{type:"text/plain;charset=utf-8"});saveAs(s,t+".txt")}else console.log("error");$("#"+e).css("pointer-events","auto")}},{key:"convertImagesToBase64",value:function(e){var t=($("#"+e+"-content").html(),$("#"+e+"-content img")),n=document.createElement("canvas"),i=n.getContext("2d");[].forEach.call(t,function(e){i.clearRect(0,0,n.width,n.height),n.width=e.width,n.height=e.height,i.drawImage(e,0,0);var t=n.toDataURL();e.setAttribute("src",t)}),n.remove()}},{key:"deleteFile",value:function(e){if(globalBot.agent(function(e){e.speak("Are you sure you want to delete this file?")}),"file-0000000000001"===e||"file-0000000000002"===e)return void t.setDialogBox("desktop","Error","1","You can not delete this file.");var n=$.grep(JSON.parse(localStorage.getItem("users")).users,function(e){return e.username==JSON.parse(localStorage.getItem("currentUser")).username});if(1==n.length)var i=n[0];for(var s=0;s<i.files.length;s++)i.files[s].fileID===e&&i.files.splice(s,1);var a=JSON.parse(localStorage.getItem("users"));$.each(a.users,function(e,t){if(this.username===JSON.parse(localStorage.getItem("currentUser")).username)return this.files=i.files,!1}),localStorage.setItem("users",JSON.stringify(a)),$('.desktop-icon[fileid="'+e+'"').remove(),$('.window[fileid="'+e+'"]').attr("saved",!1)}},{key:"attach",value:function(e){for(var t=$(e).closest("[id]").parent().closest("[id]").attr("id"),n="#"+t,i=$(n+" #attach .fileID").val().split("|"),s=0;s<i.length;s++)this.attachCreate(n,i[s])}},{key:"attachCreate",value:function(e,t){var n=this;n.parentID,t&&(n.file=this.getFileFromLocal(t),n.fileBlob="","pdf"===n.file.type?(n.fileBlob="pdf",n.attachAppend(e,n.file,n.fileBlob)):this.fileToBlob(n.file.content,n.file.type,function(t){n.fileBlob=t,n.attachAppend(e,n.file,n.fileBlob)}))}},{key:"attachAppend",value:function(e,n,i){if($(e+' div.attachment [file-id="'+n.fileID+'"]').length<1){var s=programData.getIconByType(n.type),a='<div file-id="'+n.fileID+'" class="attached-list">\n\t\t<img class="icon" src="'+s+'"/>\n\t\t<span>'+n.filename+'</span>\n\t\t<div class="cancel" >\n\t\t&nbsp;\n\t\t</div>\n\t\t</div>';$(a).appendTo(e+" div.attachment"),$('[file-id="'+n.fileID+'"]').data({file:i}),$(e+" #attach").css("display","none"),$(e).css("pointer-events","auto")}else t.setDialogBox(e,"Attach","1","You have already attached "+n.filename+"."+n.type)}},{key:"fileToBlob",value:function(e,t,n){var i=this;if(i.blob="",i.contentDocument=e,"word"===t||"doc"===t)$.cachedScript("scripts/vendor.js").done(function(t,s){var a="<!DOCTYPE html><html><head></head><body>"+e+"</body></html>",o="potrait";i.blob=htmlDocx.asBlob(a,{orientation:o}),n(i.blob)});else if("text"===t||"txt"===t){var s=e.trim();i.blob=new Blob([s],{type:"text/plain;charset=utf-8"}),n(i.blob)}else i.blob="blobError",n(i.blob)}},{key:"attachPDFData",value:function(e,t,n,i,s){this.filename=n,this.fileID=t,this.parentId=e}},{key:"appendTask",value:function(e,t,n,i){var s=this;n=n.substring(1);var a="task-"+n,o=programData.getIcon(t),l='<span class="window-open" id="'+a+'" pid="'+e+'" program-name="'+t+' "title="'+i+'">\n\t\t\t<img class="icon" src="'+o+'"/>\n\t\t\t<p class="text">'+i+"</p>\n\t\t</span>'";$(l).appendTo("#task").promise().done(function(){}),s.setTaskPosition()}},{key:"setTaskPosition",value:function(){var e,t=$("#taskbar").outerWidth()-228,n=$(".window-open").length,i=parseInt($(".window-open").css("max-width"),10);parseInt($(".window-open").css("min-width"),10);e=n>0&&n*i>t?Math.round(t/n)-10:i,e<31?(this.taskSplit(),e=30):this.taskNoSplit(),$(".window-open").css("width",e)}},{key:"taskSplit",value:function(){var e,t,n=$(".window-open"),i=Math.round(($("#taskbar").outerWidth()-228)/30)-11,s=n.length,a=Math.ceil(s/i),o=$('<span id="task"></span>'),l=1,r=0;for(t=1;t<=a;t++)e='<span id= "task-'+t+'" class="task-page" style="display:none;" page-num="'+t+'"></span>',$(o).append(e);for(t=0;t<s;t++)r++,$(o).children("#task-"+l).append(n[t]),r>=i&&(l++,r=0);$("#task").replaceWith(o),$("#task-"+l).css("display","inline").addClass("active-page"),a>1?$("#pagination").css("visibility","visible"):(this.showTaskPage(1),$("#pagination").css("visibility","hidden"))}},{key:"showTaskPage",value:function(e){$(".task-page").css("display","none").removeClass("active-page"),$("#task-"+e).css("display","inline").addClass("active-page")}},{key:"upTaskPage",value:function(){var e=$(".task-page").length,t=parseInt($(".active-page").attr("page-num"));t++,t<1||t>e?"":this.showTaskPage(t)}},{key:"downTaskPage",value:function(){var e=$(".task-page").length,t=parseInt($(".active-page").attr("page-num"));t--,t<1||t>e?"":this.showTaskPage(t)}},{key:"taskNoSplit",value:function(){var e=0;return e}},{key:"removeTask",value:function(e){$('#taskbar [pid="'+e+'"]').remove(),this.setTaskPosition()}},{key:"setTaskActive",value:function(e){$("#task span.active-task").removeClass("active-task"),$('#task [pid="'+e+'"]').addClass("active-task")}},{key:"setTaskInActive",value:function(e){$("#task span.active-task").removeClass("active-task")}},{key:"minimizeTask",value:function(e){$('#task [pid="'+e+'"]').removeClass("active-task")}},{key:"getDesktopPos",value:function(){var e,t,n=$('.desktop-icon[program-name!="recyclebin"]'),i=71,s=82,a=$(window).height(),o=($(window).width(),Math.floor(a/(i+8))),l=0,r=0,c=0;n.each(function(n){if(c++,e=parseInt($(this).css("top"),10),t=parseInt($(this).css("left"),10),console.log("Top: "+e+"/"+i+"="),console.log("Left: "+t+"/"+s+"="),0!=n){if(e%i!=0){var a=document.elementFromPoint(r*s+8,l*i+8);return!!a.classList.contains("desktop-icon")&&void 0}if(l=e/i+1,t%s!=0){var a=document.elementFromPoint(r*s+8,l*i+8);return!!a.classList.contains("desktop-icon")&&void 0}r=t/s,l>o&&(l=0,r++)}});var d={left1:r*s,top1:l*i};return d}},{key:"setDesktop",value:function(){var e,t,n,i,s=this.getFromLocal(),a=this;$.each(s,function(s,o){if("file-0000000000001"!==o.fileID){n=o.type,i=o.filename,"doc"===n||"word"===n?(e="doc",t="images/win98_icons/WINWORD_2.ico"):"pdf"===n?(e=n,t="images/win98_icons/pdf.png"):"txt"===n&&(e=n,t="images/win98_icons/notepad_file.ico"),a.iconNumber++;var l='<div draggable="true" id="desktop-icon-'+a.iconNumber+'" class="desktop-icon user-file" data-item="'+a.iconNumber+'" tabindex="0" fileID="'+o.fileID+'" program-name="'+o.program+'" type="'+e+'" style="background:url('+t+') no-repeat center top;background-size: 32px; "><p class="text" style="text-align:center;"><span>'+i+"</span></p></div>";$(l).appendTo("#desktop-icons").draggable({opacity:.7,delay:400,snap:[71,82],containment:"#desktop"})}}),setTimeout(function(){$("#desktop-icons").setInitialIcons()},500)}},{key:"setNewDesktop",value:function(e,t,n,i,s){var a,o,l=this,r="";s&&(r="shortcut");var c=this.getDesktopPos();"doc"===i||"word"===i?(a="doc",o="images/win98_icons/WINWORD_2.ico"):"pdf"===i?(a=i,o="images/win98_icons/pdf.png"):"txt"===i&&(a=i,o="images/win98_icons/notepad_file.ico"),l.iconNumber++;var d='<div draggable="true" id="desktop-icon-'+l.iconNumber+'" class="desktop-icon user-file '+r+' " data-item="'+l.iconNumber+'" tabindex="0" fileID="'+e+'" program-name="'+t+'" type="'+a+'" style="background:url('+o+") no-repeat center top;background-size: 32px; top:"+c.top1+"px; left:"+c.left1+'px;"><p class="text" style="text-align:center; margin-left:-10px;"><span>'+n+"</span></p></div>";$(d).appendTo("#desktop-icons").draggable({opacity:.7,delay:400,grid:[64,64],containment:"#desktop"})}},{key:"newWord",value:function(e){var n=this,i=this.newProcess();if(e)var s=new MsWord(i,e);else var s=new MsWord(i);_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addProcess",this).call(this,i,"msword",s.windowID,s.description),n.setWindowPosition(s.windowID),n.appendTask(i,"msword",s.windowID,s.description),n.setActive(i)}},{key:"newMail",value:function(e){var n=this,i=this.newProcess(),s=new MailClient(i);_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addProcess",this).call(this,i,"mail",s.windowID,s.description),n.setWindowPosition(s.windowID),n.appendTask(i,"mail",s.windowID,s.description),n.setActive(i),n.attachCreate(s.windowID,e)}},{key:"sendEmail",value:function(e){var n=$("#"+e+" input.sendTo").val().split(","),i=$("#"+e+" input.sendToCC").val().split(",");n>1&&t.setDialogBox(e,"Email address","1","Please enter only 1 email address to send an email to"),i>1&&t.setDialogBox(e,"Email address","1","Please enter only 1 email address to send a carbon copy to");for(var s=$("#"+e+" input.subject").val(),a=$("#"+e+"div.attachement").children(),o=0;o<a.length;o++)$(a[o]).data();var l=$("#"+e+" .mail-content").text();window.open("mailto:"+n[0]+"?cc="+i[0]+"&subject="+s+"&body="+l)}},{key:"contextMenuInit",value:function(){var e,n,i=this;$.contextMenu({className:"desktop-context-menu",selector:".user-file",callback:function(s,a){var o=s;switch(s){case"open":i.program(this);break;case"print":e=i.getFileFromLocal($(this).attr("fileid")),i.print(e.content);break;case"desktop":alert(o);break;case"mail":i.newMail($(this).attr("fileid"));break;case"delete":var l=(t.setDialogBox("desktop","Delete File","6","Are you sure you want to permenently delete '"+$(this).text()+"."+$(this).attr("type")+"'?"),this);$("#desktop #dialog button").on("click",function(){var e=$(this).attr("value");"yes"==e&&i.deleteFile($(l).attr("fileid"))});break;case"createShortcut":e=i.getFileFromLocal($(this).attr("fileid")),i.setNewDesktop(e.fileID,e.program,e.filename,e.type,!0);break;case"properties":i.properties($(this).attr("fileid"));break;case"rename":$(this).children().children().attr("contentEditable",!0),$(this).children().children().focus();var l=this;$(this).children().children().on("blur",function(){$(this).removeAttr("contentEditable"),$(this).removeAttr("autocomplete"),n=$(this).text(),i.rename($(l).attr("fileid"),n)});break;default:console.log("Shouldnt")}},items:{open:{name:"Open",accesskey:"O",className:"context-menu-bold"},print:{name:"Print",accesskey:"P"},sep1:"---------",sendTo:{name:"Send To",accesskey:"T",items:{desktop:{name:"Desktop",accesskey:"D"},mail:{name:"Mail Recipient",accesskey:"M"}}},sep2:"---------",cut:{name:"Cut",accesskey:"t",disabled:!0},copy:{name:"Copy",accesskey:"c",disabled:!0},sep3:"---------",createShortcut:{name:"Create Shortcut",accesskey:"s"},"delete":{name:"Delete",accesskey:"d"},rename:{name:"Rename",accesskey:"m"},sep4:"---------",properties:{name:"Properties",accesskey:"r"}}}),$.contextMenu({selector:".word .menu-bar .file",trigger:"left",position:function(e,t,n){var i=this.offset();e.$menu.css({top:i.top+10,left:i.left-10})},className:"word-file-context-menu",callback:function(e,n){var s=$(this).closest("[id]").attr("id");switch(e){case"new":i.newWord();break;case"open":i.showOpen(s);break;case"close":case"exit":$("#"+s+" a.button-3d.close").trigger("click");break;case"print":i.printFile(s);break;case"save":i.showSave(s);break;case"saveAs":i.showSave(s);break;case"mail":"true"===$("#"+s).attr("saved")&&"undefined"!=$("#"+s).attr("fileid")?i.newMail($("#"+s).attr("fileid")):t.setDialogBox(s,"Error","1","Please save your file before you continue.");break;default:console.log("Shouldnt")}},items:{"new":{name:"New",accesskey:"O",icon:function(e,t,n,i){return t.html('<a class="b-new" aria-hidden="true"></a> <p><span class="context-menu-accesskey">N</span>ew</p>'),"context-menu-icon-updated"}},open:{name:"Open",accesskey:"O",icon:function(e,t,n,i){return t.html('<a class="b-open" aria-hidden="true"></a> <p><span class="context-menu-accesskey">O</span>pen</p>'),"context-menu-icon-updated"}},close:{name:"Close",accesskey:"C"},sep1:"---------",save:{name:"Save",accesskey:"s",icon:function(e,t,n,i){return t.html('<a class="b-save" aria-hidden="true"></a> <p><span class="context-menu-accesskey">S</span>ave</p>'),"context-menu-icon-updated"}},saveAs:{name:"Save As",accesskey:"A"},saveAsHtml:{name:"Save As HTML",accesskey:"H",disabled:!0},version:{name:"Versions",accesskey:"V",disabled:!0},sep2:"---------",pageSet:{name:"Page Setup",accesskey:"u",disabled:!0},printPreview:{name:"Print Preview",accesskey:"v",icon:function(e,t,n,i){return t.html('<a class="b-preview" aria-hidden="true"></a> <p>Print Pre<span class="context-menu-accesskey">v</span>iew </p>'),"context-menu-icon-updated"},disabled:!0},print:{name:"Print",accesskey:"P",icon:function(e,t,n,i){return t.html('<a class="b-print" aria-hidden="true"></a> <p><span class="context-menu-accesskey">P</span>rint</p>'),"context-menu-icon-updated"}},sep3:"---------",sendTo:{name:"Send To",accesskey:"T",items:{mail:{name:"Mail Recipient",accesskey:"M",icon:function(e,t,n,i){return t.html('<a class="b-mail" aria-hidden="true"></a> <p><span class="context-menu-accesskey">M</span>ail Recipient...</p>'),"context-menu-icon-updated"}}}},properties:{name:"Properties",accesskey:"r",disabled:!0},sep4:"---------",exit:{name:"Exit",accesskey:"e"}}}),$.contextMenu({selector:".notepad .menu-bar .file",trigger:"left",position:function(e,t,n){var i=this.offset();e.$menu.css({top:i.top+10,left:i.left-10})},className:"notepad-file-context-menu",callback:function(e,t){var n=$(this).closest("[id]").attr("id");switch(e){case"new":$("#desktop-icon-5").trigger("dblclick");break;case"open":i.showOpen(n);break;case"exit":$("#"+n+" a.button-3d.close").trigger("click");break;case"print":i.printFile(n);break;case"save":i.showSave(n);break;case"saveAs":i.showSave(n);break;default:console.log("Shouldnt")}},items:{"new":{name:"New",accesskey:"O"},open:{name:"Open",accesskey:"O"},sep1:"---------",save:{name:"Save",accesskey:"s"},saveAs:{name:"Save As",accesskey:"A"},sep2:"---------",pageSet:{name:"Page Setup",accesskey:"u",disabled:!0},print:{name:"Print",accesskey:"P"},sep3:"---------",exit:{name:"Exit",accesskey:"e"}}})}}],[{key:"insertOverlay",value:function(e,t){if(t)var n='<div id="overlay" width="100%" height="100%" style="background:url(images/word%20images/background123.png);"></div>';else var n='<div id="overlay" width="100%" height="100%""></div>';$("body").append(n);var i=2147483644;$("#overlay").css("zIndex",i-1),$("#"+e).css("zIndex",i),$("#overlay").on("click",function(e){e.stopPropagation(),sound.play("sprite2")})}},{key:"removeOverlay",value:function(){$("#overlay").each(function(){$(this).remove()})}},{key:"setDialogBox",value:function(e,n,i,s){0==e.indexOf("#")&&(e=e.slice(1,e.length));var a='<div id="dialog" class="dialog window active-window ui-widget-content"> <div class="window-border"> <div class="title-bar h-count"> <div class="control-box"> <a class="button-3d close-dialog"><span>&nbsp;</span></a> </div> <span class="title"> '+n+' </span> </div> <div class="error-content"> <div class="text"> <img class="icon" src="images/win98_icons/exclamation.ico"/> <p>'+s+'</p><br> </div> <div class="button"></div> </div> </div>';"body"!==e?$(a).appendTo("#"+e):$(a).appendTo("body"),$("#dialog .title").text(n),"1"==i||"error"==i?($("#"+e+" #dialog img").attr("src","../images/win98_icons/error.ico"),$("#dialog .button").append("<button value='ok'>Ok</button>")):"2"==i||"warning"==i?($("#dialog img").attr("src","../images/win98_icons/exclamation.ico"),$("#dialog .button").append("<button value='yes'>Yes</button>")):"3"==i||"information"==i?($("#dialog img").attr("src","../images/win98_icons/information.ico"),$("#dialog .button").append("<button value='yes'>Yes</button>")):"4"==i||"replace"==i||"leave"==i?($("#dialog img").attr("src","../images/win98_icons/exclamation.ico"),$("#dialog .button").html("<button value='yes'>Yes</button><button value='no'>No</button><button value='cancel'>Cancel</button>")):"5"==i||"logoff"==i?($("#dialog img").attr("src","../images/win98_icons/key_win.ico"),$("#dialog .button").html("<button value='yes'>Yes</button><button value='no'>No</button>")):"6"!=i&&"delete"!=i||($("#dialog img").attr("src","../images/win98_icons/erase_file.ico"),$("#dialog .button").html("<button value='yes'>Yes</button><button value='no'>No</button>")),$("#"+e+" #dialog").css("display","block"),t.insertOverlay(e,!1),$("#"+e+" #dialog").css("zIndex",2147483645),$("#"+e+" #dialog").css("position","fixed"),$("#"+e).css("pointer-events","none"),$("#"+e+" #save").css("pointer-events","none"),$("#"+e+" #open").css("pointer-events","none"),$("#"+e+" #dialog").css("pointer-events","auto"),$("#"+e+" #dialog .title-bar").css("pointer-events","none"),$("#dialog button").on("click",function(){t.removeOverlay(),$("#"+e).css("pointer-events","auto"),$("#"+e+" #save").css("pointer-events","auto"),$("#"+e+" #open").css("pointer-events","auto"),$("#"+e+" #dialog").remove()})}}]),t}(process),Explorer=function(){function e(t,n){_classCallCheck(this,e),this.processID=t,this.directory=n;var i=this.create();return i}return _createClass(e,[{key:"create",value:function(){var e=this.append();return e}},{key:"append",value:function(){var e=kernel.getFileFromLocal("file-0000000000001"),t=programData.getIconByType(e.type),n='<div class="folder-icon user-file" tabindex="0" fileID="'+e.fileID+'" program-name="'+e.program+'" type="'+e.extension+'" style="background:url('+t+') no-repeat center top;background-size: 32px; "><p class="text" style="text-align:center;"><span>'+e.filename+"</span></p></div>",i=this.getDirectoryContents(),s='<div id="explorer-'+this.processID+'" class="explorer window ui-widget-content" program-name="explorer" pid="'+this.processID+'" directory="'+this.directory+'">\n            <div class="window-border">\n                <div class="title-bar" id="parent">\n                    <div class="control-box">\n                        <a class="button-3d minimize"><span>&nbsp;</span></a>\n                        <a class="button-3d maximize" state="min"><span>&nbsp;</span></a>\n                        <a class="button-3d close"><span>&nbsp;</span></a>\n                    </div>\n                    <span class="title">\n                    '+i.title+'\n                    </span>\n                </div>\n                <div class="top">\n                    <div class="menu-bar  h-count">\n                        <span class="f-sep"></span>\n                        <a><span>F</span>ile</a>\n                        <a><span>E</span>dit</a>\n                        <a><span>V</span>iew</a>\n                        <a><span>G</span>o</a>\n                        <a>F<span>a</span>vourites</a>\n                        <a><span>H</span>elp</a>\n                        <div class="clear"></div>\n                    </div>\n                    <span class="hr-sep"></span>\n                    <div class="clear"></div>\n                </div>\n                <div class="explorer-top-bar">\n                    <a class="b-back"></a>\n                    <a class="b-forward"></a>\n                    <a class="b-up"></a>\n                    <span class="sep"></span>\n                    <a class="b-cut"></a>\n                    <a class="b-copy"></a>\n                    <a class="b-paste"></a>\n                    <a class="b-undo"></a>\n                    <span class="sep"></span>\n                    <a class="b-delete"></a>\n                    <a class="b-properties"></a>\n                </div>\n                <div class="header-info">\n                    <div class="middle-bar">\n                        <p class="to">Address:</p>\n                        <input type="text" id="address-bar" value="'+i.title+'" />\n                    </div>\n                </div>\n                <div id="explorer-content" class="content">\n                    <div class="left-side">\n                        <div class="explorer-icon"></div>\n                        <div class="explorer-header">\n                            '+i.title+'\n                        </div>\n                        <div class="underline-header">\n                            <!-- <div class="red"></div>\n                            <div class="yellow"></div>\n                            <div class="green"></div>\n                            <div class="blue"></div> -->\n                        </div>\n                        <br>\n                        <div class="sub-header">Select an item to view its description</div>\n                    </div>\n                    <div class="right-side">\n                        <div class="folder-location">\n                            <div class="folder-url folder-icon" directory="root" tabindex="0" style="background:url(images/win98_icons/msie2.ico) no-repeat center top;" url="https://github.com/lolstring">\n                                <p class="text"><span>Github</span></p>\n                            </div>\n                            <div class="folder-url folder-icon" directory="root" tabindex="0" style="background:url(images/win98_icons/msie2.ico) no-repeat center top;" url="https://linkedin.com/in/rahmehra">\n                                <p class="text"><span>LinkedIn</span></p>\n                            </div>\n                            <div class="folder-url folder-icon" directory="root" tabindex="0" style="background:url(images/win98_icons/msie2.ico) no-repeat center top;" url="https://youtube.com/user/lolstring909">\n                                <p class="text"><span>Youtube</span></p>\n                            </div>\n                            '+n+'\n                        </div>\n                    </div>\n                </div>\n                <div class="status-bar  h-count" id="status-bar-1">\n                    <div class="status-bar-content">\n                        <span class="box" style="width:20%">\n                    </span>\n                         <span class="box size" style="width:50%">\n                         \n                    </span>\n                        <span class="box" style="width:25%">\n                        <img class="status-folder-icon" src="images/win98_icons/directory_open.ico"></img>'+i.title+"\n                    </span>\n                    </div>\n                </div>\n            </div>\n        </div>";
$(s).appendTo("#desktop").show("fast").draggable({handle:".title-bar"});var a=$("#explorer-"+this.processID+" #explorer-content");return $("#explorer-"+this.processID).resizable({alsoResize:a}),{windowID:"#explorer-"+this.processID,description:"My projects"}}},{key:"getDirectoryContents",value:function(){return{title:"My Projects",location:"Desktop/My Projects",type:"folder"}}}]),e}(),Notepad=function(){function e(t,n){_classCallCheck(this,e),this.fileID=n,this.processID=t;var i=this.create();return i}return _createClass(e,[{key:"saveListener",value:function(){var e=$('[pid="'+this.processID+'"] .document-wrap'),t=$(e).html();$(e).blur(function(){t!=$(this).html()&&$(this).closest("div[pid]").attr("saved",!1)})}},{key:"create",value:function(){if(this.a++,this.fileID)var e=kernel.getFileFromLocal(this.fileID),t=e.filename+" - Notepad",n=e.content,i=e.filename,s=e.type;else{var t="Untitled - Notepad";n='<div class="clear"></div>',i="Unitled",s=""}var a=this.append(i,n,s,t);return this.saveListener(),{windowID:a,description:t}}},{key:"append",value:function(e,t,n,i){var s='contenteditable="true"',a='<div id="notepad-'+this.processID+'" class="notepad window ui-widget-content" pid="'+this.processID+'" program-name="notepad" fileID='+this.fileID+' saved="true">\n            <div class="window-border">\n                <div class="title-bar  h-count" id="parent">\n                    <div class="control-box">\n                        <a class="button-3d minimize"><span>&nbsp;</span></a>\n                        <a class="button-3d maximize" state="min"><span>&nbsp;</span></a>\n                        <a class="button-3d close"><span>&nbsp;</span></a>\n                    </div>\n                    <span class="title">\n                   '+i+'\n                  </span>\n                </div>\n                <div class="menu-bar  h-count">\n                    <a class="file"><span>F</span>ile</a>\n                    <a><span>E</span>dit</a>\n                    <a><span>S</span>earch</a>\n                    <a><span>H</span>elp</a>\n                    <div class="clear"></div>\n                </div>\n                <div class="clear"></div>\n                <div id="notepad-'+this.processID+'-content" class="content ui-widget-content">\n                    <div class="content-box">\n                        <div class="document-scroller">\n                            <div class="document-content">\n                                <div class="document container">\n                                    <div class="document-wrap" '+s+">\n                                        "+t+'</div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n        <div id="open" class="ui-widget-content">\n          <div class="window-border">\n            <div class="title-bar  h-count">\n              <div class="control-box">\n                <a class="button-3d question-save disabled-action" tabindex="-1"><span>&nbsp;</span></a>\n                <a class="button-3d close-save"><span>&nbsp;</span></a>\n              </div>\n              <span class="title">\n                Open\n              </span>\n            </div>\n            <div class="open-content">\n              <div class="top-bar">\n                <a><span>Look in: </span></a>\n                <!--<div class="picker"><span class="arrow"></span><img class="icon" src="images/win98_icons/desktop.ico"/><span>Desktop</span></div>-->\n                <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; ">\n                <option  disabled selected value="desktop">Desktop</option><!--<option value="both">Download and Save</option>--></select>\n                <!--<div class="picker ui-widget">\n                  <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; "><option value="desktop">Desktop</option><option value="computer">My Computer(Download)</option><option value="both">Download and Save</option></select></div>-->\n                  <div class="action up"></div>\n                  <div class="action desktop-ico" style="margin-left:4px"></div>\n                  <div class="action new" style="margin-left:4px"></div>\n                  <div class="action icon-view" style="margin-left:4px"></div>\n                  <div class="action list-view"></div>\n                  <div class="clear"></div>\n                </div>\n                <div class="folders">\n                  <div class="content1-box" >\n                    <div id="my-computer" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/computer_explorer.ico" style="width:14px;"/><span style="vertical-align:top">My Computer</span></div>\n                    <div id="my-computer" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/directory_open_file_mydocs.ico" style="width:14px;"/><span style="vertical-align:top">My Documents</span></div>\n                    <div id="my-computer" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/network_normal_two_pcs.ico" style="width:14px;"/><span style="vertical-align:top">Network Neighbourhood</span></div>\n                  </div>\n                </div>\n                <div class="bottom-bar">\n                  <p class="text">File Name:</p><input type="text" class="filename" style="position:relative;"><button class="open-button" style="margin-left:12px"><u>O</u>pen</button>\n                </div>\n                <!--<div class="bottom-bar">\n                  <p class="text">Save as type:</p><div class="picker" style="margin:10px 0 10px 10px; width:200px;"><span class="arrow"></span><span>Portable Document File</span></div> <button id="cancel-button""><u>C</u>ancel</button>\n                </div>-->\n                <div class="bottom-bar">\n                  <p class="text">File of type:</p><select id="file-type" class="picker select" style="margin:0px 3px 10px 26px; width:230px; "><option value="pdf">PDF</option><option value="doc" selected>Word</option><option value="txt">Text Document</option></select> <button class="cancel-button"><u>C</u>ancel</button>\n                </div>\n                  <input type="hidden" class="fileID" value="">\n                </div>\n            </div>\n        </div>\n        <div id="save" class="ui-widget-content" style="display:none;">\n          <div class="window-border">\n            <div class="title-bar  h-count">\n              <div class="control-box">\n                <a class="button-3d question-save disabled-action"  tabindex="-1"><span>&nbsp;</span></a>\n                <a class="button-3d close-save"><span>&nbsp;</span></a>\n              </div>\n              <span class="title">\n                Save\n              </span>\n            </div>\n            <div class="save-content">\n              <div class="top-bar">\n                <a><span>Save in:</span></a>\n                <!--<div class="picker"><span class="arrow"></span><img class="icon" src="images/win98_icons/desktop.ico"/><span>Desktop</span></div>-->\n                <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; "><option disabled selected value="none"></option>\n                <option value="desktop">Desktop</option><option value="computer">My Computer(Download)</option><!--<option value="both">Download and Save</option>--></select>\n                <!--<div class="picker ui-widget">\n                  <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; "><option value="desktop">Desktop</option><option value="computer">My Computer(Download)</option><option value="both">Download and Save</option></select></div>-->\n                  <div class="action up"></div>\n                  <div class="action desktop-ico" style="margin-left:4px"></div>\n                  <div class="action new" style="margin-left:4px"></div>\n                  <div class="action icon-view" style="margin-left:4px"></div>\n                  <div class="action list-view"></div>\n                  <div class="clear"></div>\n                </div>\n                <div class="folders">\n                  <div class="content1-box" >\n                    <div program-name="explorer" directory="root" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/computer_explorer.ico" style="width:14px;"/><span style="vertical-align:top">My Computer</span></div>\n                    <div program-name="explorer" directory="documents" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/directory_open_file_mydocs.ico" style="width:14px;"/><span style="vertical-align:top">My Documents</span></div>\n                    <div class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/network_normal_two_pcs.ico" style="width:14px;"/><span style="vertical-align:top">Network Neighbourhood</span></div>\n                  </div>\n                </div>\n                <div class="bottom-bar">\n                  <p class="text">File Name:</p><input type="text" class="filename" style="position:relative;" value="'+e+'"><button class="save-button" style="margin-left:12px"><u>S</u>ave</button>\n                </div>\n                <!--<div class="bottom-bar">\n                  <p class="text">Save as type:</p><div class="picker" style="margin:10px 0 10px 10px; width:200px;"><span class="arrow"></span><span>Portable Document File</span></div> <button id="cancel-button"><u>C</u>ancel</button>\n                </div>-->\n                <div class="bottom-bar">\n                  <p class="text">Save as type:</p><select id="file-type" class="picker select" style="margin:0px 4px 10px 15px; width:230px; "><option value="pdf">PDF</option><option value="doc" selected>Word</option><option value="txt">Text Document</option></select> <button class="cancel-button"><u>C</u>ancel</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>';$(a).appendTo("#desktop").show("fast").draggable({handle:".title-bar",containment:"#desktop",scroll:!1});"#notepad-"+this.processID+"-content .document-content";return $("#notepad-"+this.processID).resizable({}),$("#notepad-"+this.processID+" #save").draggable({handle:".title-bar",containment:"#desktop",scroll:!1}),$("#notepad-"+this.processID+" #open").draggable({handle:".title-bar",containment:"#desktop",scroll:!1}),"#notepad-"+this.processID}}]),e}(),MsWord=function(){function e(t,n){_classCallCheck(this,e),this.a=0,this.fileID=n,this.processID=t;var i=this.create();return this.toolbar(),i}return _createClass(e,[{key:"init",value:function(){}},{key:"saveListener",value:function(){var e=$('[pid="'+this.processID+'"] .document-wrap'),t=$(e).html();$(e).blur(function(){t!=$(this).html()&&$(this).closest("div[pid]").attr("saved",!1)})}},{key:"toolbar",value:function(){$(".toolbar a").on("mousedown",function(e){$(".document-wrap").blur(),e.stopPropagation();var t=$(e.currentTarget),n=t.data("cmd");if(n){e.preventDefault();try{document.execCommand(n,!1,null)}catch(e){}}}),$("select").on("mousedown",function(n){n.stopPropagation(),n.target===this&&(t=e.selectHTML())}),$("select#fontSize").on("change",function(n){var i;t&&(window.getSelection?(i=window.getSelection(),i.removeAllRanges(),i.addRange(t)):document.selection&&t.select&&t.select()),n.stopPropagation();var s=this.value;try{e.execFontSize(s,"px")}catch(n){console.log(n)}}),$("select.selectPicker").on("change",function(e){var t=$(e.currentTarget),n=t.data("cmd"),i=this.value;if(n){e.preventDefault();try{document.execCommand(n,!1,i)}catch(e){console.log(e)}}});var t=null;$(".toolbar .b-paste").on("mousedown",function(e){e.stopPropagation(),document.execCommand("paste",!1,null)}),$(".toolbar .b-paste").on("mouseup",function(e){}),$(".toolbar .b-hilite").on("mousedown",function(n){n.stopPropagation(),$(".document-wrap").blur(),n.target===this&&($(".color-picker").css("display","none"),$(this).children().css("display","block"),t=e.selectHTML())}),$(".toolbar .b-hilite").on("mouseup",function(e){e.stopPropagation();var n;$(".document-wrap").blur(),t&&(window.getSelection?(n=window.getSelection(),n.removeAllRanges(),n.addRange(t)):document.selection&&t.select&&t.select())}),$(".toolbar .b-hilite .color-picker a").on("mousedown",function(e){$(".document-wrap").blur();var t=$(this).css("background-color");$(this).closest("div").css("display","none");try{document.execCommand("backColor",!1,t)}catch(e){console.log("No Support")}e.stopPropagation()}),$(".toolbar .b-fontcolor").on("mousedown",function(n){$(".document-wrap").blur(),n.target===this&&($(".color-picker").css("display","none"),$(this).children().css("display","block"),t=e.selectHTML())}),$(".toolbar .b-fontcolor").on("mouseup",function(e){var n;$(".document-wrap").blur(),t&&(window.getSelection?(n=window.getSelection(),n.removeAllRanges(),n.addRange(t)):document.selection&&t.select&&t.select()),e.stopPropagation()}),$(".toolbar .b-fontcolor .color-picker a").on("mousedown",function(e){var t=$(this).css("background-color");$(this).closest("div").css("display","none");try{document.execCommand("foreColor",!1,t)}catch(e){console.log("No Support")}e.stopPropagation()})}},{key:"create",value:function(){this.a++;var t=e._wordNumberStore();if(this.fileID)var n=kernel.getFileFromLocal(this.fileID),i=n.filename+" - Microsoft Word",s=n.content,a=n.filename,o=n.type;else{var i="Document "+t+" - Microsoft Word";s='<div class="clear"></div>',a="Document "+t,o=""}var l=this.append(t,a,s,o,i);return this.saveListener(),{windowID:l,description:i}}},{key:"append",value:function(e,t,n,i,s){var a='contenteditable="true"';"file-0000000000001"!==this.fileID&&"file-0000000000002"!==this.fileID||(a="",s+=" (Read Only)");var o='<div id="word-'+e+'" class="word window ui-widget-content" pid="'+this.processID+'" program-name="msword" document-number='+e+" fileID="+this.fileID+' saved="true">\n        <div class="window-border">\n          <div class="title-bar  h-count" id="parent">\n            <div class="control-box">\n              <a class="button-3d minimize"><span>&nbsp;</span></a>\n              <a class="button-3d maximize" state="min"><span>&nbsp;</span></a>\n              <a class="button-3d close"><span>&nbsp;</span></a>\n            </div>\n            <span class="title">\n              '+s+'\n            </span>\n          </div>\n          <div class="menu-bar  h-count">\n            <a class="file"><span>F</span>ile</a>\n            <a class="disabled-action"><span>E</span>dit</a>\n            <a class="disabled-action" tabindex="-1"><span>V</span>iew</a>\n            <a class="disabled-action" tabindex="-1"><span>I</span>nsert</a>\n            <a class="disabled-action" tabindex="-1">F<span>o</span>rmat</a>\n            <a class="disabled-action" tabindex="-1"><span>T</span>ools</a>\n            <a class="disabled-action" tabindex="-1">T<span>a</span>ble</a>\n            <a class="disabled-action" tabindex="-1"><span>W</span>indow</a>\n            <a class="disabled-action" tabindex="-1"><span>H</span>elp</a>\n            <div class="clear"></div>\n          </div>\n          <div class="toolbar float-left">\n            <a class="b-new" tabindex="0"></a>\n            <a class="b-open" tabindex="0"></a>\n            <a class="b-save" tabindex="0"></a>\n            <span class="sep"></span>\n            <a class="b-print" tabindex="0"></a>\n            <a class="b-preview" tabindex="0"></a>\n            <a class="b-spell disabled-action-toolbar" tabindex="-1"></a>\n            <span class="sep"></span>\n            <a class="b-cut" data-cmd="cut" tabindex="0"></a>\n            <a class="b-copy" data-cmd="copy" tabindex="0"></a>\n            <a class="b-paste disabled-action-toolbar"  tabindex="-1" data-cmd="paste"></a>\n            <a class="b-style-brush disabled-action-toolbar"  tabindex="-1"></a>\n            <span class="sep"></span>\n            <a class="b-undo" data-cmd="undo" tabindex="0"></a>\n            <a class="b-redo"  data-cmd="redo" tabindex="0"></a>\n            <div class="clear"></div>\n          </div>\n          <div class="toolbar  float-left">\n            <select class="selectPicker" data-cmd="formatBlock" style="background-position:96% 50%, 98% 50%; width:112px; overflow:hidden; text-overflow: ellipsis;">\n              <option value="H1"><h1>Heading 1</h1></option>\n              <option value="H2"><h2>Heading 2</h2></option>\n              <option value="H3"><h3>Heading 3</h3></option>\n              <option value="div"><pre>Normal</pre></option>\n              <option selected value="P"><p>Default Paragraph Font</p></option>\n            </select>\n            <select class="selectPicker" id="font" data-cmd="fontName" style="width:168px; overflow:hidden; text-overflow: ellipsis;">\n              <option value="Arial" selected>Arial</option>\n              <option value="Georgia">Georgia</option>\n              <option value="Times New Roman">Times New Roman</option>\n              <option value="Arial Black">Arial Black</option>\n              <option value="Comic Sans MS">Comic Sans MS</option>\n              <option value="Impact">Impact</option>\n              <option value="Lucida Sans Unicode">Lucida Sans Unicode</option>\n              <option value="Tahoma">Tahoma</option>\n              <option value="Trebuchet MS">Trebuchet MS</option>\n              <option value="Verdana">Verdana</option>\n              <option value="Courier New">Courier New</option>\n              <option value="Lucida Console">Lucida Console</option>\n            </select>\n            <select class="selectPicker" id="fontSize" style="background-position:92% 50%, 95% 50%; width:64px; overflow:hidden;text-overflow: ellipsis;">\n              <option value="8" >8</option>\n              <option value="9" >9</option>\n              <option value="10" >10</option>\n              <option value="11" >11</option>\n              <option value="12" selected >12</option>\n              <option value="14" >14</option>\n              <option value="16" >16</option>\n              <option value="18" >18</option>\n              <option value="20" >20</option>\n              <option value="22" >22</option>\n              <option value="24" >24</option>\n              <option value="26" >26</option>\n              <option value="28" >28</option>\n              <option value="30" >30</option>\n              <option value="32" >32</option>\n              <option value="34" >34</option>\n              <option value="36" >36</option>\n              <option value="48" >48</option>\n              <option value="72" >72</option>\n              \n            </select>\n          </div>\n          <div class="toolbar  float-left">\n            <a class="b-bold" data-cmd="bold" tabindex="0"></a>\n            <a class="b-italic" data-cmd="italic" tabindex="0"></a>\n            <a class="b-underline"  data-cmd="underline" tabindex="0"></a>\n            <span class="sep"></span>\n            <a class="b-left"  data-cmd="justifyLeft" tabindex="0"></a>\n            <a class="b-center" data-cmd="justifyCenter" tabindex="0"></a>\n            <a class="b-right" data-cmd="justifyRight" tabindex="0"></a>\n            <span class="sep"></span>\n            <a class="b-number" data-cmd="insertOrderedList" tabindex="0"></a>\n            <a class="b-bullet" data-cmd="insertUnorderedList" tabindex="0"></a>\n            <a class="b-outdent" data-cmd="outdent" tabindex="0"></a>\n            <a class="b-indent" data-cmd="indent" tabindex="0"></a>\n            <span class="sep"></span>\n            <a class="b-hilite" data-cmd="backColor" tabindex="0">\n              <div class="color-picker" style="position:fixed; background:#c0c0c0; z-index:99; display:none;">\n                <table>\n                  <tr>\n                    <td colspan="8" style="padding:3px"><a style="background:none; border:1px solid; width:100%; height:100%; text-align:center; vertical-align:middle;font-size:10px">None</a></td>\n                  </tr>\n                  <tr>\n                    <td><a style="background:black"></a></td>\n                    <td><a style="background:darkgrey">&nbsp;</a></td>\n                    <td><a style="background:darkred">&nbsp;</a></td>\n                    <td><a style="background:#808088">&nbsp;</a></td>\n                    <td><a style="background:darkgreen">&nbsp;</a></td>\n                    <td><a style="background:teal">&nbsp;</a></td>.\n                    <td><a style="background:darkblue">&nbsp;</a></td>\n                    <td><a style="background:violet">&nbsp;</a></td>\n                  </tr>\n                  <tr>\n                    <td><a style="background:white">&nbsp;</a></td>\n                    <td><a style="background:lightgrey">&nbsp;</a></td>\n                    <td><a style="background:red">&nbsp;</a></td>\n                    <td><a style="background:yellow">&nbsp;</a></td>\n                    <td><a style="background:green">&nbsp;</a></td>\n                    <td><a style="background:lightblue">&nbsp;</a></td>\n                    <td><a style="background:darkblue">&nbsp;</a></td>\n                    <td><a style="background:pink">&nbsp;</a></td>\n                  </tr>\n                </table>\n              </div>\n            </a>\n            <a class="b-fontcolor"  tabindex="0">\n              <div class="color-picker" style="position:fixed; background:#c0c0c0; z-index:99; display:none;">\n                <table>\n                  <tr>\n                    <td colspan="8" style="padding:3px"><a style="background:black;background-size:10px,10px; border:1px solid; width:100%; height:100%; text-align:center; vertical-align:middle;color:white;">Automatic</a></td>\n                  </tr>\n                  <tr>\n                    <td><a style="background:black"></a></td>\n                    <td><a style="background:darkgrey">&nbsp;</a></td>\n                    <td><a style="background:darkred">&nbsp;</a></td>\n                    <td><a style="background:#808088">&nbsp;</a></td>\n                    <td><a style="background:darkgreen">&nbsp;</a></td>\n                    <td><a style="background:teal">&nbsp;</a></td>.\n                    <td><a style="background:darkblue">&nbsp;</a></td>\n                    <td><a style="background:violet">&nbsp;</a></td>\n                  </tr>\n                  <tr>\n                    <td><a style="background:white">&nbsp;</a></td>\n                    <td><a style="background:lightgrey">&nbsp;</a></td>\n                    <td><a style="background:red">&nbsp;</a></td>\n                    <td><a style="background:yellow">&nbsp;</a></td>\n                    <td><a style="background:green">&nbsp;</a></td>\n                    <td><a style="background:lightblue">&nbsp;</a></td>\n                    <td><a style="background:darkblue">&nbsp;</a></td>\n                    <td><a style="background:pink">&nbsp;</a></td>\n                  </tr>\n                </table>\n              </div>\n            </a>\n            <div class="clear"></div>\n          </div>\n          <div class="clear"></div>\n          <div id="word-'+e+'-content" class="content ui-widget-content">\n            <div class="content-box">\n              <div class="top-ruler  h-count">\n                <div class="ruler"></div>\n              </div>\n              <div class="left-ruler"></div>\n              <div class="document-scroller">\n                <div class="document-content">\n                  <div class="document container">\n                    <div class="document-wrap" '+a+' tabindex="0">\n                      '+n+'\n                      <div class="clear"></div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class="status-bar disable-action h-count" id="status-bar-1">\n            <div class="status-bar-content">\n              <span class="box">\n                Page 1\n                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n                Sec 1\n                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n                1/1\n                &nbsp;&nbsp;&nbsp;&nbsp;\n              </span>\n              <span class="box">\n                At 1"\n                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n                Ln 1\n                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n                Col 1\n                &nbsp;&nbsp;&nbsp;&nbsp;\n              </span>\n              <span class="box disabled">\n                REC\n              </span>\n              <span class="box disabled">\n                TRK\n              </span>\n              <span class="box disabled">\n                EXT\n              </span>\n              <span class="box disabled">\n                OVR\n              </span>\n            </div>\n          </div>\n        </div>\n        <div id="open" class="ui-widget-content">\n          <div class="window-border">\n            <div class="title-bar  h-count">\n              <div class="control-box">\n                <a class="button-3d question-save disabled-action" tabindex="-1"><span>&nbsp;</span></a>\n                <a class="button-3d close-save"><span>&nbsp;</span></a>\n              </div>\n              <span class="title">\n                Open\n              </span>\n            </div>\n            <div class="open-content">\n              <div class="top-bar">\n                <a><span>Look in: </span></a>\n                <!--<div class="picker"><span class="arrow"></span><img class="icon" src="images/win98_icons/desktop.ico"/><span>Desktop</span></div>-->\n                <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; ">\n                <option  disabled selected value="desktop">Desktop</option><!--<option value="both">Download and Save</option>--></select>\n                <!--<div class="picker ui-widget">\n                  <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; "><option value="desktop">Desktop</option><option value="computer">My Computer(Download)</option><option value="both">Download and Save</option></select></div>-->\n                  <div class="action up"></div>\n                  <div class="action desktop-ico" style="margin-left:4px"></div>\n                  <div class="action new" style="margin-left:4px"></div>\n                  <div class="action icon-view" style="margin-left:4px"></div>\n                  <div class="action list-view"></div>\n                  <div class="clear"></div>\n                </div>\n                <div class="folders">\n                  <div class="content1-box" >\n                    <div id="my-computer" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/computer_explorer.ico" style="width:14px;"/><span style="vertical-align:top">My Computer</span></div>\n                    <div id="my-computer" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/directory_open_file_mydocs.ico" style="width:14px;"/><span style="vertical-align:top">My Documents</span></div>\n                    <div id="my-computer" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/network_normal_two_pcs.ico" style="width:14px;"/><span style="vertical-align:top">Network Neighbourhood</span></div>\n                  </div>\n                </div>\n                <div class="bottom-bar">\n                  <p class="text">File Name:</p><input type="text" class="filename" style="position:relative;"><button class="open-button" style="margin-left:12px"><u>O</u>pen</button>\n                </div>\n                <!--<div class="bottom-bar">\n                  <p class="text">Save as type:</p><div class="picker" style="margin:10px 0 10px 10px; width:200px;"><span class="arrow"></span><span>Portable Document File</span></div> <button id="cancel-button""><u>C</u>ancel</button>\n                </div>-->\n                <div class="bottom-bar">\n                  <p class="text">File of type:</p><select id="file-type" class="picker select" style="margin:0px 3px 10px 26px; width:230px; "><option value="pdf">PDF</option><option value="doc" selected>Word</option><option value="txt">Text Document</option></select> <button class="cancel-button"><u>C</u>ancel</button>\n                </div>\n                  <input type="hidden" class="fileID" value="">\n                </div>\n            </div>\n        </div>\n        <div id="save" class="ui-widget-content" style="display:none;">\n          <div class="window-border">\n            <div class="title-bar  h-count">\n              <div class="control-box">\n                <a class="button-3d question-save disabled-action"  tabindex="-1"><span>&nbsp;</span></a>\n                <a class="button-3d close-save"><span>&nbsp;</span></a>\n              </div>\n              <span class="title">\n                Save\n              </span>\n            </div>\n            <div class="save-content">\n              <div class="top-bar">\n                <a><span>Save in:</span></a>\n                <!--<div class="picker"><span class="arrow"></span><img class="icon" src="images/win98_icons/desktop.ico"/><span>Desktop</span></div>-->\n                <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; "><option disabled selected value="none"></option>\n                <option value="desktop">Desktop</option><option value="computer">My Computer(Download)</option><!--<option value="both">Download and Save</option>--></select>\n                <!--<div class="picker ui-widget">\n                  <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; "><option value="desktop">Desktop</option><option value="computer">My Computer(Download)</option><option value="both">Download and Save</option></select></div>-->\n                  <div class="action up"></div>\n                  <div class="action desktop-ico" style="margin-left:4px"></div>\n                  <div class="action new" style="margin-left:4px"></div>\n                  <div class="action icon-view" style="margin-left:4px"></div>\n                  <div class="action list-view"></div>\n                  <div class="clear"></div>\n                </div>\n                <div class="folders">\n                  <div class="content1-box" >\n                    <div program-name="explorer" directory="root" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/computer_explorer.ico" style="width:14px;"/><span style="vertical-align:top">My Computer</span></div>\n                    <div program-name="explorer" directory="documents" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/directory_open_file_mydocs.ico" style="width:14px;"/><span style="vertical-align:top">My Documents</span></div>\n                    <div class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/network_normal_two_pcs.ico" style="width:14px;"/><span style="vertical-align:top">Network Neighbourhood</span></div>\n                  </div>\n                </div>\n                <div class="bottom-bar">\n                  <p class="text">File Name:</p><input type="text" class="filename" style="position:relative;" value="'+t+'"><button class="save-button" style="margin-left:12px"><u>S</u>ave</button>\n                </div>\n                <!--<div class="bottom-bar">\n                  <p class="text">Save as type:</p><div class="picker" style="margin:10px 0 10px 10px; width:200px;"><span class="arrow"></span><span>Portable Document File</span></div> <button id="cancel-button"><u>C</u>ancel</button>\n                </div>-->\n                <div class="bottom-bar">\n                  <p class="text">Save as type:</p><select id="file-type" class="picker select" style="margin:0px 4px 10px 15px; width:230px; "><option value="pdf">PDF</option><option value="doc" selected>Word</option><option value="txt">Text Document</option></select> <button class="cancel-button"><u>C</u>ancel</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>';
$(o).appendTo("#desktop").show("fast").draggable({handle:".title-bar",containment:"#desktop",scroll:!1});var l="#word-"+e+"-content .document-content";return $("#word-"+e).resizable({alsoResize:l}),$("#word-"+e+" #save").draggable({handle:".title-bar",containment:"#desktop",scroll:!1}),$("#word-"+e+" #open").draggable({handle:".title-bar",containment:"#desktop",scroll:!1}),"#word-"+e}}],[{key:"execFontSize",value:function(e,t){var n=$("<span/>",{text:document.getSelection()}).css("font-size",e+t).prop("outerHTML");document.execCommand("insertHTML",!1,n)}},{key:"selectHTML",value:function(){var e;if($(".document-wrap").blur(),window.getSelection){if(e=window.getSelection(),e.getRangeAt&&e.rangeCount)return e.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null}},{key:"_wordNumberStore",value:function(){var e=JSON.parse(localStorage.getItem("docNumber")),t=completeArr(e);return localStorage.setItem("docNumber",JSON.stringify(e)),t}},{key:"_wordNumberRemove",value:function(e){e=parseInt(e);var t=JSON.parse(localStorage.getItem("docNumber"));removeArr(t,e);return localStorage.setItem("docNumber",JSON.stringify(t)),!0}},{key:"remove",value:function(t,n){var i="word-"+t,s=$("#"+i).attr("saved");if("false"==s){SystemUI.setDialogBox(i,"Microsoft Word","4","Are you sure you want to close before exiting?");$("#"+i+" #dialog button").on("click",function(){$("#"+i).css("pointer-events","auto");var s=$(this).attr("value");"yes"==s?(e._wordNumberRemove(t),n(!0)):"no"==s?n(!1):"cancel"==s&&n(!1)})}else e._wordNumberRemove(t),n(!0)}}]),e}(),Wolf3d=function(){function e(t){_classCallCheck(this,e),this.processID=t;var n=this.create();return n}return _createClass(e,[{key:"create",value:function(){var e=this.append();return e}},{key:"append",value:function(){var e=' <div id="wolf" class="wolf window ui-widget-content" program-name="wolf-3d" style="display:block;" pid="'+this.processID+'">\n            <div class="window-border">\n                <div class="title-bar  h-count" id="parent">\n                    <div class="control-box">\n                        <a class="button-3d minimize"><span>&nbsp;</span></a>\n                        <a class="button-3d maximize" state="min"><span>&nbsp;</span></a>\n                        <a class="button-3d close"><span>&nbsp;</span></a>\n                    </div>\n                    <span class="title">\n                   Wolf 3d\n                  </span>\n                </div>\n            <div class="wolf-content">\n                <iframe id="wolf-frame" src="installed-programs/wolf3d/index.html" width="640" height="480"></iframe>\n            </div>\n            </div>\n        </div>';return $(e).appendTo("#desktop").show("fast").draggable({handle:".title-bar",containment:"#desktop",scroll:!1}),{windowID:"#wolf",description:"Wolf 3D"}}}]),e}(),Winamp=function(){function e(t){_classCallCheck(this,e),this.processID=t;var n=this.create();return n}return _createClass(e,[{key:"create",value:function(){var e=this.append();return e}},{key:"append",value:function(){var e='<div id=\'winamp2-js\' class="winamp window" tabindex="-1" program-name="winamp" pid="'+this.processID+'"></div>\n                    <script src="installed-programs/winamp2-js/built/winamp.js"></script>';return $(e).appendTo("#desktop").show("fast"),$("#winamp2-js").draggable({handle:".title-bar"}),{windowID:"#winamp2-js",description:"Winamp Music Player"}}}]),e}(),Minesweeper=function(){function e(t){_classCallCheck(this,e),this.processID=t;var n=this.create();return n}return _createClass(e,[{key:"create",value:function(){var e=this.append();return e}},{key:"append",value:function(){var e=' <div id="minesweeper" class="window ui-widget-content" style="display:block;" program-name="minesweeper" pid = "'+this.processID+'">\n              <div class="window-border">\n              <div class="title-bar  h-count" id="parent">\n                <div class="control-box">\n                  <a class="button-3d minimize"><span>&nbsp;</span></a>\n                  <a class="button-3d maximize"><span>&nbsp;</span></a>\n                  <a class="button-3d close"><span>&nbsp;</span></a>\n                </div>\n                <span class="title">\n                  Minesweeper\n                </span>\n              </div>\n              <div class="clear"></div>\n              <div id="minesweeper-content">\n                <iframe src="installed-programs/mine/minecore.html" id="mine-frame" scrolling="no" ></iframe>\n              </div>\n              </div>\n            </div>';return $(e).appendTo("#desktop").show("fast").draggable({handle:".title-bar"}),{windowID:"#minesweeper",description:"minesweeper"}}}]),e}(),MailClient=function(){function e(t){_classCallCheck(this,e),this.processID=t,this.init(),this.toolbar();var n=this.create();return n}return _createClass(e,[{key:"init",value:function(){}},{key:"create",value:function(){var e=this.append();return e}},{key:"append",value:function(e){var e="mail-"+this.processID,t='<div id="mail-'+this.processID+'" class="mail window ui-widget-content" program-name="mail" style="display:block" pid="'+this.processID+'">\n            <div class="window-border">\n                <div class="title-bar  h-count" id="parent">\n                    <div class="control-box">\n                        <a class="button-3d minimize"><span>&nbsp;</span></a>\n                        <a class="button-3d maximize" state="min"><span>&nbsp;</span></a>\n                        <a class="button-3d close"><span>&nbsp;</span></a>\n                    </div>\n                    <span class="title">\n                   Mail Client\n                  </span>\n                </div>\n                <div class="top">\n                    \n                    <div class="menu-bar  h-count">\n                    <span class="f-sep"></span>\n                        <a><span>F</span>ile</a>\n                        <a><span>E</span>dit</a>\n                        <a><span>V</span>iew</a>\n                        <a><span>I</span>nsert</a>\n                        <a>F<span>o</span>ormat</a>\n                        <a><span>T</span>ools</a>\n                        <a><span>M</span>essage</a>\n                        <a><span>H</span>elp</a>\n                        <div class="clear"></div>\n                    </div>\n                    <span class="hr-sep"></span>\n                    <div class="clear"></div>\n                </div>\n                <div class="mail-top-bar">\n                    <span class="f-sep"></span>\n                    <a class="b-send"></a>\n                    <span class="sep"></span>\n                    <a class="b-cut"></a>\n                    <a class="b-copy"></a>\n                    <a class="b-paste"></a>\n                    <a class="b-undo"></a>\n                    <span class="sep"></span>\n                    <a class="b-attach"></a>\n                </div>\n                <div class="header-info">\n                <div class="middle-bar">\n                        <p class="to">To:</p>\n                        <input type="text" class="sendTo" />\n                </div>\n                <div class="middle-bar">\n                        <p class="cc">CC:</p>\n                        <input type="text" class="sendToCC" />\n                </div>\n                <div class="middle-bar">\n                        <p class="subject">Subject:&thinsp;</p>\n                        <input type="text" class="subject" />\n                </div>\n                <div class="middle-bar">\n                        <p class="attachment">Attach:&nbsp;&nbsp;</p>\n                        <div class="attachment">\n                \t\t</div>\n                </div>\n                <div class="toolbar">\n                    <select class="selectPicker" data-cmd="formatBlock" style="background-position:96% 50%, 99% 50%; width:112px; overflow:hidden; text-overflow: ellipsis;">\n                        <option value="H1">\n                            <h1>Heading 1</h1></option>\n                        <option value="H2">\n                            <h2>Heading 2</h2></option>\n                        <option value="H3">\n                            <h3>Heading 3</h3></option>\n                        <option value="div"><pre>Normal</pre></option>\n                        <option selected value="P">\n                            <p>Default Paragraph Font</p>\n                        </option>\n                    </select>\n                    <select class="selectPicker" id="font" data-cmd="fontName" style="width:168px; overflow:hidden; text-overflow: ellipsis;">\n                        <option value="Arial" selected>Arial</option>\n                        <option value="Georgia">Georgia</option>\n                        <option value="Times New Roman">Times New Roman</option>\n                        <option value="Arial Black">Arial Black</option>\n                        <option value="Comic Sans MS">Comic Sans MS</option>\n                        <option value="Impact">Impact</option>\n                        <option value="Lucida Sans Unicode">Lucida Sans Unicode</option>\n                        <option value="Tahoma">Tahoma</option>\n                        <option value="Trebuchet MS">Trebuchet MS</option>\n                        <option value="Verdana">Verdana</option>\n                        <option value="Courier New">Courier New</option>\n                        <option value="Lucida Console">Lucida Console</option>\n                    </select>\n                    <select class="selectPicker" id="fontSize" style="background-position:93% 50%, 96% 50%; width:64px; overflow:hidden;text-overflow: ellipsis;">\n                        <option value="8">8</option>\n                        <option value="9">9</option>\n                        <option value="10">10</option>\n                        <option value="11">11</option>\n                        <option value="12" selected>12</option>\n                        <option value="14">14</option>\n                        <option value="16">16</option>\n                        <option value="18">18</option>\n                        <option value="20">20</option>\n                        <option value="22">22</option>\n                        <option value="24">24</option>\n                        <option value="26">26</option>\n                        <option value="28">28</option>\n                        <option value="30">30</option>\n                        <option value="32">32</option>\n                        <option value="34">34</option>\n                        <option value="36">36</option>\n                        <option value="48">48</option>\n                        <option value="72">72</option>\n                    </select>\n                    <a class="b-bold" data-cmd="bold"></a>\n                    <a class="b-italic" data-cmd="italic"></a>\n                    <a class="b-underline" data-cmd="underline"></a>\n                    <span class="sep"></span>\n                    <a class="b-left" data-cmd="justifyLeft"></a>\n                    <a class="b-center" data-cmd="justifyCenter"></a>\n                    <a class="b-right" data-cmd="justifyRight"></a>\n                    <span class="sep"></span>\n                    <a class="b-number" data-cmd="insertOrderedList"></a>\n                    <a class="b-bullet" data-cmd="insertUnorderedList"></a>\n                    <a class="b-outdent" data-cmd="outdent"></a>\n                    <a class="b-indent" data-cmd="indent"></a>\n                </div>\n                <div class="mail-content" contenteditable="true">\n                </div>\n                <div class="mail-bottom-bar"></div>\n            </div>\n          <div id="attach" class="ui-widget-content">\n          <div class="window-border">\n            <div class="title-bar  h-count">\n              <div class="control-box">\n                <a class="button-3d question-save disabled-action" tabindex="-1"><span>&nbsp;</span></a>\n                <a class="button-3d close-save"><span>&nbsp;</span></a>\n              </div>\n              <span class="title">\n                Attach\n              </span>\n            </div>\n            <div class="attach-content">\n              <div class="top-bar">\n                <a><span>Look in: </span></a>\n                <!--<div class="picker"><span class="arrow"></span><img class="icon" src="images/win98_icons/desktop.ico"/><span>Desktop</span></div>-->\n                <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; ">\n                <option  disabled selected value="desktop">Desktop</option><!--<option value="both">Download and Save</option>--></select>\n                <!--<div class="picker ui-widget">\n                  <select id="save-location" class="picker select" style="margin:3px 4px 3px 12px; width:180px; "><option value="desktop">Desktop</option><option value="computer">My Computer(Download)</option><option value="both">Download and Save</option></select></div>-->\n                  <div class="action up"></div>\n                  <div class="action desktop-ico" style="margin-left:4px"></div>\n                  <div class="action new" style="margin-left:4px"></div>\n                  <div class="action icon-view" style="margin-left:4px"></div>\n                  <div class="action list-view"></div>\n                  <div class="clear"></div>\n                </div>\n                <div class="folders">\n                  <div class="content1-box" >\n                    <div id="my-computer" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/computer_explorer.ico" style="width:14px;"/><span style="vertical-align:top">My Computer</span></div>\n                    <div id="my-computer" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/directory_open_file_mydocs.ico" style="width:14px;"/><span style="vertical-align:top">My Documents</span></div>\n                    <div id="my-computer" class="folder-list" style="left:0px;"><img class="icon" src="images/win98_icons/network_normal_two_pcs.ico" style="width:14px;"/><span style="vertical-align:top">Network Neighbourhood</span></div>\n                  </div>\n                </div>\n                <div class="bottom-bar">\n                  <p class="text">File Name:</p><input type="text" class="filename" style="position:relative;"><button class="attach-button" style="margin-left:12px"><u>A</u>ttach</button>\n                </div>\n                <!--<div class="bottom-bar">\n                  <p class="text">Save as type:</p><div class="picker" style="margin:10px 0 10px 10px; width:200px;"><span class="arrow"></span><span>Portable Document File</span></div> <button id="cancel-button""><u>C</u>ancel</button>\n                </div>-->\n                <div class="bottom-bar">\n                  <p class="text">File of type:</p><select id="file-type" class="picker select" style="margin:0px 4px 10px 15px; width:230px; "><option value="pdf">PDF</option><option value="doc" selected>Word</option><option value="txt">Text Document</option></select> <button class="cancel-button"><u>C</u>ancel</button>\n                </div>\n                  <input type="hidden" class="fileID" value="">\n                </div>\n            </div>\n          </div>\n        </div>';$(t).appendTo("#desktop").show("fast").draggable({handle:".title-bar"});var n="#"+e+" .mail-content";return $("#mail"+e).resizable({alsoResize:n}),$("#"+e+" #attach").draggable({handle:".title-bar"}),{windowID:"#mail-"+this.processID,description:"Mail Client"}}},{key:"toolbar",value:function(){$(".toolbar a").on("mousedown",function(e){e.stopPropagation();var t=$(e.currentTarget),n=t.data("cmd");if(n){e.preventDefault();try{document.execCommand(n,!1,null)}catch(e){}}}),$("select#fontSize").on("change",function(e){var t=this.value;try{MsWord.execFontSize(t,"px")}catch(e){console.log(e)}}),$("select.selectPicker").on("change",function(e){var t=$(e.currentTarget),n=t.data("cmd"),i=this.value;if(n){e.preventDefault();try{document.execCommand(n,!1,i)}catch(e){console.log(e)}}});var e=null;$(".toolbar .b-paste").on("mousedown",function(e){e.stopPropagation(),document.execCommand("paste",!1,null)}),$(".toolbar .b-paste").on("mouseup",function(e){}),$(".toolbar .b-hilite").on("mousedown",function(t){t.stopPropagation(),t.target===this&&($(".color-picker").css("display","none"),$(this).children().css("display","block"),e=MsWord.selectHTML())}),$(".toolbar .b-hilite").on("mouseup",function(t){t.stopPropagation();var n;e&&(window.getSelection?(n=window.getSelection(),n.removeAllRanges(),n.addRange(e)):document.selection&&e.select&&e.select())}),$(".toolbar .b-hilite .color-picker a").on("mousedown",function(e){var t=$(this).css("background-color");$(this).closest("div").css("display","none");try{document.execCommand("backColor",!1,t)}catch(e){console.log("No Support")}e.stopPropagation()}),$(".toolbar .b-fontcolor").on("mousedown",function(t){t.target===this&&($(".color-picker").css("display","none"),$(this).children().css("display","block"),e=MsWord.selectHTML())}),$(".toolbar .b-fontcolor").on("mouseup",function(t){var n;e&&(window.getSelection?(n=window.getSelection(),n.removeAllRanges(),n.addRange(e)):document.selection&&e.select&&e.select()),t.stopPropagation()}),$(".toolbar .b-fontcolor .color-picker a").on("mousedown",function(e){var t=$(this).css("background-color");$(this).closest("div").css("display","none");try{document.execCommand("foreColor",!1,t)}catch(e){console.log("No Support")}e.stopPropagation()})}}]),e}(),bot=function(){function e(t){_classCallCheck(this,e),this._el=t,this._agentDfd=null,this._agentEls=this._el.find(".characters a"),this._setupEvents()}return _createClass(e,[{key:"_setupEvents",value:function(){this._agentEls.click($.proxy(this._onAgentClick,this))}},{key:"_onAgentClick",value:function(e){var t=$(e.currentTarget),n=t.data("item")}},{key:"switchAgent",value:function(e){if(this._agentEls.removeClass("active"),this._agentEls.removeClass("loading"),this._agentName=e,this._getAgentEl(e).addClass("active").addClass("loading"),$(".run-example").hide(),this._clearActions(),this._el.addClass("loading"),this._agentDfd){var t=$.Deferred();return this.agent($.proxy(function(n){n.hide(!1,$.proxy(function(){this._switchAgentInternal(e).done(t.resolve)},this))},this)),t.promise()}return this._switchAgentInternal(e)}},{key:"_switchAgentInternal",value:function(e){return this._agentDfd=$.Deferred(),clippy.load(e,$.proxy(this._onAgentReady,this)),this._agentDfd.promise()}},{key:"_onAgentReady",value:function(e){this._agentDfd.resolve(e),e.show(),this._getAgentEl(this._agentName).removeClass("loading"),this._setupActions(e),this._el.removeClass("loading"),$(".run-example").show()}},{key:"_getAgentEl",value:function(e){return this._agentEls.filter("[data-item="+e+"]")}},{key:"_clearActions",value:function(){$(".actions-content").html('<span class="loading">Loading...</span> ')}},{key:"_setupActions",value:function(e){for(var t="",n=e.animations().sort(),i=0;i<n.length;i++){var s=n[i];t+='<a class="action no-select" contenteditable="false" data-id="'+s+'">'+s+"</a>"}$(".actions-content").html(t)}},{key:"play",value:function(e,t){this.agent(function(n){n.stop(),n.play(e,void 0,t)})}},{key:"speak",value:function(e){this.agent(function(t){t.speak(e)})}},{key:"agent",value:function(e){if(this._agentDfd){var t=this._agentDfd;return $.isFunction(e)&&t&&t.done(e),t.promise()}}},{key:"isReady",value:function(){return this._agentDfd&&this._agentDfd.isResolved&&this._agentDfd.isResolved()}},{key:"_onRunExampleClick",value:function(e){var t=$(e.currentTarget),n=t.data("key");if(n){var i=this._exampleFuncs[n];i&&this.agent($.proxy(i,this))}}}]),e}(),login=function(){function e(){_classCallCheck(this,e),this.eventListeners(),this.sound=new sound,this.login()}return _createClass(e,[{key:"greetings",value:function(){globalBot.speak("Hi, welcome to a recreation of Windows 98 on the web. I am Clippy and I am going to help you around this site."),isFirstLogin()&&globalBot.agent(function(e){e.speak("This website allows you to relive Windows 98 in a browser. You can login using your own username after logging out."),setTimeout(function(){e.moveTo(250,250),e.gestureAt(50,250),e.speak("Start here")},1e4)})}},{key:"eventListeners",value:function(){var e=this;$("#login").off().on("click",".close,.cancel",function(){e.login()}),$("#login").off().on("click",".ok-button",function(t){t.stopPropagation(),t.preventDefault(),e.login()}),$(".audio-button").off().on("click",function(){$(".audio-button").toggleClass("mute"),sound.toggleSound()}),$(window).load(function(){e.greetings()})}},{key:"login",value:function(){var e=$("#username").val()||"Rahul";if(Modernizr.localstorage){var t=localStorage.getItem("users");null!==t?this.userExists(e)?this.setExistingUser(e):this.addNewUser(e):(this.firstVisit(),this.addNewUser(e)),this.setup()}else console.log("No Storage"),$("#login").css("display","none"),$("#desktop").css("display","block"),sound.play("sprite8")}},{key:"userExists",value:function(e){var t=JSON.parse(localStorage.getItem("users")),n=!1;return $.each(t.users,function(){if(this.username===e)return n=!0,!1}),n}},{key:"addNewUser",value:function(e){var t=JSON.parse(localStorage.getItem("users")),n={username:e,creationDate:Date.now(),lastLogin:Date.now(),files:[],displayname:e,pref:{sound:!$(".audio-button").hasClass("mute"),background:""},email:""};n.files.push({fileID:"file-0000000000001",filename:"My Details",content:'<span style="font-size: 20px;">RAHUL MEHRA<br></span><div style="padding: 0px; margin: -3px;"><br></div><div style="line-height: 21px; border: 1px solid; padding: 4px;"><b>Location:&nbsp;</b>Australia.&nbsp;<b>E-Mail:</b>&nbsp;<a href="mailto:rahulmehra@techgeek.co.in">rahulmehra@techgeek.co.in</a>&nbsp;<b>GIT:</b>&nbsp;<a href="https://github.com/lolstring">https://github.com/lolstring</a>&nbsp;<br></div><div style="line-height: 21px;"><br></div>',type:"doc",program:"msword",creationDate:14769702e5,modifiedDate:14769702e5}),n.files.push({fileID:"file-0000000000002",filename:"License and Credits",content:'\n<h3> License </h3><br>\n<br>\nThe Windows 98 name, interface, and sample audio files are a property of\nMicrosoft Corporation, the code within this project is released under the [MIT\nLicense].<br>\n<br>\nThe MIT License (MIT)<br>\n<br>\nCopyright (c) [2016-2017] [Rahul Mehra]<br>\n<br>\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:<br>\n<br>\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.<br>\n<br>\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.<br>\n<br>\n<h3>Credits :</h3> <br>\n\nWolf3d - https://github.com/jseidelin/wolf3d<br>\nClippy - https://github.com/smore-inc/clippy.js<br>\nWinamp2 - https://github.com/captbaritone/winamp2-js<br>\n<br>\nPlease see their respective licenses.\n',type:"doc",program:"msword",creationDate:14769702e5,modifiedDate:14769702e5}),t.users.push(n),localStorage.setItem("users",JSON.stringify(t)),localStorage.setItem("currentUser",JSON.stringify(n))}},{key:"setExistingUser",value:function(e){var t,n=JSON.parse(localStorage.getItem("users"));$.each(n.users,function(n,i){if(this.username===e)return this.lastLogin=Date.now(),this.pref.sound=!$(".audio-button").hasClass("mute"),t=i,!1}),localStorage.setItem("users",JSON.stringify(n)),localStorage.setItem("currentUser",JSON.stringify(t))}},{key:"firstVisit",value:function(){var e={users:[]};return localStorage.setItem("users",JSON.stringify(e)),!0}},{key:"setup",value:function(){var e=new kernel;e.store(),this.ui=new SystemUI,this.ui.init(),this.ui.eventListeners(),this.ui.setDesktop(),$("#login").css("display","none"),$("#desktop").css("display","block"),$(".audio-button").hasClass("mute")?$("#clock > .volume").attr("src","images/win98_icons/volumemute.ico"):$("#clock > .volume").attr("src","images/win98_icons/volume.ico"),sound.play("sprite8")}},{key:"loaded",value:function(){$(window).load(function(){return!0})}}]),e}(),sound=function(){function e(){_classCallCheck(this,e);var t=this,n={urls:["../sounds/combinedSound.ogg","../sounds/combinedSound.m4a","../sounds/combinedSound.mp3","../sounds/combinedSound.ac3"],sprite:{CHIMES:[0,631.3378684807255],CHORD:[2e3,1098.9115646258504],DING:[5e3,915.6916099773244],LOGOFF:[7e3,3549.0249433106574],NOTIFY:[12e3,1352.5170068027207],RECYCLE:[15e3,574.6485260770982],START:[17e3,45.89569160997797],TADA:[19e3,1938.866213151929],TMS:[22e3,7858.503401360544]},spriteMap:{sprite0:"CHIMES",sprite1:"CHORD",sprite2:"DING",sprite3:"LOGOFF",sprite4:"NOTIFY",sprite5:"RECYCLE",sprite6:"START",sprite7:"TADA",sprite8:"TMS"}};t.sounds=[],t._spriteMap=n.spriteMap,t._sprite=n.sprite,t.sound=new Howl({src:n.urls,sprite:n.sprite})}return _createClass(e,null,[{
key:"toggleSound",value:function(e){var t=JSON.parse(localStorage.getItem("currentUser"));t.pref.sound=!$(".audio-button").hasClass("mute"),localStorage.setItem("currentUser",JSON.stringify(t)),0!=$('.window[program-name="wolf-3d"]').length&&($(".audio-button").hasClass("mute")?(console.log("Sound Disabled"),document.getElementById("wolf-frame").contentWindow.Wolf.Sound.toggle()):(console.log("Sound Enabled"),document.getElementById("wolf-frame").contentWindow.Wolf.Sound.toggle("enable")))}},{key:"play",value:function(e){var t=this;if(JSON.parse(localStorage.getItem("currentUser")).pref.sound===!0){var n={urls:["../sounds/combinedSound.ogg","../sounds/combinedSound.m4a","../sounds/combinedSound.mp3","../sounds/combinedSound.ac3"],sprite:{CHIMES:[0,631.3378684807255],CHORD:[2e3,1098.9115646258504],DING:[5e3,915.6916099773244],LOGOFF:[7e3,3549.0249433106574],NOTIFY:[12e3,1352.5170068027207],RECYCLE:[15e3,574.6485260770982],START:[17e3,45.89569160997797],TADA:[19e3,1938.866213151929],TMS:[22e3,7858.503401360544]},spriteMap:{sprite0:"CHIMES",sprite1:"CHORD",sprite2:"DING",sprite3:"LOGOFF",sprite4:"NOTIFY",sprite5:"RECYCLE",sprite6:"START",sprite7:"TADA",sprite8:"TMS"}};t.sounds=[],t._spriteMap=n.spriteMap,t._sprite=n.sprite,t.sound=new Howl({src:n.urls,sprite:n.sprite});var t=this,i=t._spriteMap[e];t.sound.play(i)}}}]),e}(),globalBot=new bot($("body"));globalBot.switchAgent("Clippy"),main(),startTime();